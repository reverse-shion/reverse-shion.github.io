:root{
  --bg: #05060b;

  --txt: rgba(245,245,245,.92);
  --muted: rgba(245,245,245,.65);

  --cyan: rgba(0,240,255,.95);
  --gold: rgba(230,201,107,.95);
  --vio: rgba(156,60,255,.95);

  /* myth tones */
  --ink: rgba(0,0,0,.38);
  --glass: rgba(255,255,255,.06);
  --glass2: rgba(255,255,255,.10);
  --line: rgba(255,255,255,.14);

  --hiero: rgba(230,201,107,.22);
  --sand:  rgba(230,201,107,.16);

  --solar:  rgba(255,210,110,.92);
  --solar2: rgba(255,120,60,.38);
  --eye:    rgba(0,240,255,.28);

  --safeB: env(safe-area-inset-bottom, 0px);
  --safeT: env(safe-area-inset-top, 0px);

  /* JS updates */
  --vh: 1vh;

  /* layout tokens */
  --hudH: 92px;     /* HUDの高さ目安 */
  --btnH: 66px;     /* ボタン帯の高さ目安 */
  --stagePadTop: 10px;
  --stagePadBottom: 10px;
}

/* ========== reset ========== */
*{ box-sizing:border-box; }
html, body{ height:100%; }
body{
  margin:0;
  background: var(--bg);
  color: var(--txt);
  font-family: system-ui, -apple-system, "Hiragino Kaku Gothic ProN", "Noto Sans JP", sans-serif;
  overflow:hidden;                 /* スクロール禁止＝崩れ防止 */
  overscroll-behavior: none;
  -webkit-tap-highlight-color: transparent;
}

/* ========== app fixed container ========== */
.app{
  position: fixed;                 /* ←重要：absoluteじゃなく固定 */
  inset: 0;
  width:100%;
  height: calc(var(--vh) * 100);
  padding-top: var(--safeT);
  padding-bottom: var(--safeB);
  overflow: hidden;
  touch-action: none;              /* iOSの変なスクロール系を根絶 */
}

/* ========== background video ========== */
.bgVideo{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  opacity:.30;
  filter: saturate(1.25) contrast(1.06);
  transform: translateZ(0);
  z-index: 1;
}

/* ========== fx layer ========== */
.fxLayer{
  position:absolute;
  inset:0;
  pointer-events:none;
  overflow:hidden;
  z-index: 6;
}

/* ========== myth layer ========== */
.mythLayer{
  position:absolute;
  inset:0;
  z-index: 2;
  pointer-events:none;
}

/* 神殿床×サイバー薄膜 */
.mythLayer::before{
  content:"";
  position:absolute;
  inset:-20%;
  background:
    radial-gradient(circle at 20% 25%, rgba(0,240,255,.09), transparent 58%),
    radial-gradient(circle at 80% 70%, rgba(156,60,255,.07), transparent 60%),
    radial-gradient(circle at 52% 40%, rgba(230,201,107,.06), transparent 62%),
    linear-gradient(180deg, rgba(255,255,255,.04), transparent 28%, rgba(0,0,0,.34));
  opacity:.95;
  filter: blur(.2px);
}

/* -------------------------
   1) Hiero Ring (THOTH)
------------------------- */
.hieroRing{
  position:absolute;
  left:50%;
  top: calc(100% - (var(--btnH) + var(--safeB) + 160px));
  width:min(420px, 86vw);
  aspect-ratio: 1/1;
  transform: translate(-50%,-50%) scale(.86);
  opacity:0;
  border-radius:999px;
  background:
    conic-gradient(from 90deg,
      transparent 0 6%,
      rgba(230,201,107,.18) 6% 7%,
      transparent 7% 12%,
      rgba(0,240,255,.14) 12% 13%,
      transparent 13% 18%,
      rgba(230,201,107,.14) 18% 19%,
      transparent 19% 24%,
      rgba(156,60,255,.10) 24% 25%,
      transparent 25% 30%,
      rgba(230,201,107,.14) 30% 31%,
      transparent 31% 100%);
  box-shadow:
    0 0 26px rgba(230,201,107,.14),
    0 0 40px rgba(0,240,255,.10);
  filter: drop-shadow(0 0 12px rgba(230,201,107,.12));
  mix-blend-mode: screen;
}
.hieroRing::before{
  content:"";
  position:absolute;
  inset:10%;
  border-radius:999px;
  border:1px dashed rgba(230,201,107,.18);
  box-shadow: inset 0 0 24px rgba(0,240,255,.10);
  opacity:.9;
}
.hieroRing::after{
  content:"";
  position:absolute;
  inset:0;
  border-radius:999px;
  background:
    repeating-conic-gradient(from 0deg,
      rgba(230,201,107,.0) 0 10deg,
      rgba(230,201,107,.12) 10deg 12deg,
      rgba(230,201,107,.0) 12deg 18deg);
  mask: radial-gradient(circle, transparent 55%, #000 56%);
  opacity:.55;
  filter: blur(.4px);
}
.hieroRing.on{
  animation: hieroPop .42s ease-out both, hieroSpin 4.2s linear infinite;
}
@keyframes hieroPop{
  0%{ opacity:0; transform: translate(-50%,-50%) scale(.62); }
  60%{ opacity:1; transform: translate(-50%,-50%) scale(.98); }
  100%{ opacity:.85; transform: translate(-50%,-50%) scale(.92); }
}
@keyframes hieroSpin{
  to{ transform: translate(-50%,-50%) scale(.92) rotate(360deg); }
}

/* -------------------------
   2) MAAT scale
------------------------- */
.maatScale{
  position:absolute;
  left:50%;
  top: calc(var(--safeT) + var(--hudH) + 18px);
  width:min(520px, 92vw);
  height:160px;
  transform: translateX(-50%);
  opacity:0;
  filter: drop-shadow(0 0 18px rgba(0,240,255,.12));
}
.maatScale .scaleBeam{
  position:absolute;
  left:50%;
  top:28px;
  width:72%;
  height:2px;
  transform: translateX(-50%);
  background: linear-gradient(90deg, transparent, rgba(230,201,107,.55), transparent);
  box-shadow: 0 0 18px rgba(230,201,107,.12);
}
.maatScale .scalePlate{
  position:absolute;
  top:44px;
  width:160px;
  height:92px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(6,6,12,.22);
  backdrop-filter: blur(8px);
  box-shadow:
    0 0 22px rgba(0,240,255,.08),
    inset 0 0 20px rgba(230,201,107,.08);
}
.maatScale .scalePlate.left{ left:8%; }
.maatScale .scalePlate.right{ right:8%; }
.maatScale .scalePlate::before{
  content:"";
  position:absolute;
  inset:10px;
  border-radius:14px;
  border:1px solid rgba(230,201,107,.12);
  background:
    radial-gradient(circle at 30% 25%, rgba(0,240,255,.12), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(230,201,107,.10), transparent 55%);
  opacity:.9;
}
.maatScale.on{ animation: scaleReveal .55s ease-out both; }
@keyframes scaleReveal{
  0%{ opacity:0; transform: translateX(-50%) translateY(-10px) scale(.98); }
  100%{ opacity:.85; transform: translateX(-50%) translateY(0) scale(1); }
}

/* -------------------------
   3) SOLAR disc
------------------------- */
.solarDisc{
  position:absolute;
  left:50%;
  top: calc(var(--safeT) + var(--hudH) + 10px);
  width:min(640px, 98vw);
  aspect-ratio: 1/1;
  transform: translate(-50%,-50%) scale(.9);
  opacity:0;
  mix-blend-mode: screen;
  filter: drop-shadow(0 0 28px rgba(255,210,110,.14));
}
.solarDisc .solarCore{
  position:absolute;
  inset:26%;
  border-radius:999px;
  background:
    radial-gradient(circle at 35% 30%, rgba(255,255,255,.38), transparent 55%),
    radial-gradient(circle, rgba(255,210,110,.55), rgba(255,120,60,.18) 62%, transparent 74%);
  box-shadow:
    0 0 46px rgba(255,210,110,.18),
    0 0 66px rgba(0,240,255,.08);
}
.solarDisc .solarRays{
  position:absolute;
  inset:0;
  border-radius:999px;
  background:
    repeating-conic-gradient(from 0deg,
      rgba(255,210,110,.0) 0 6deg,
      rgba(255,210,110,.10) 6deg 7deg,
      rgba(255,210,110,.0) 7deg 14deg);
  mask: radial-gradient(circle, transparent 46%, #000 47%);
  opacity:.75;
  filter: blur(.4px);
}
.solarDisc.on{
  animation: solarIgnite .42s ease-out both, solarSpin 6.0s linear infinite;
}
@keyframes solarIgnite{
  0%{ opacity:0; transform: translate(-50%,-50%) scale(.70); }
  55%{ opacity:1; transform: translate(-50%,-50%) scale(1.02); }
  100%{ opacity:.92; transform: translate(-50%,-50%) scale(.96); }
}
@keyframes solarSpin{
  to{ transform: translate(-50%,-50%) scale(.96) rotate(360deg); }
}

/* particle field */
.particleField{ position:absolute; inset:0; opacity:0; }
.particleField.on{
  opacity:1;
  animation: fieldBreath 1.4s ease-in-out infinite;
}
@keyframes fieldBreath{
  0%,100%{ filter: drop-shadow(0 0 8px rgba(230,201,107,.08)); }
  50%{ filter: drop-shadow(0 0 16px rgba(0,240,255,.10)); }
}

/* ========== HUD (TOP FIXED) ========== */
.hud{
  position: fixed;                 /* ←重要 */
  top: calc(var(--safeT) + 10px);
  left: 0;
  right: 0;
  z-index: 20;
  display:grid;
  grid-template-columns: 1fr 1.2fr 1fr;
  gap:12px;
  padding: 0 14px;
  align-items:start;
  pointer-events: none;            /* ゲーム操作を邪魔しない */
}

.hud .label{
  font-size:12px;
  letter-spacing:.12em;
  color: var(--muted);
}
.hud .value{
  font-size:22px;
  font-weight:900;
  text-shadow: 0 0 18px rgba(0,240,255,.25);
}
.hudMid{
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:center;
}
.combo{ display:flex; gap:10px; align-items:baseline; }
.combo .value{ font-size:26px; }

.fever{
  width:min(320px, 92%);
  padding:10px 12px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(255,255,255,.06);
  backdrop-filter: blur(10px);
  border-radius:14px;
}
.feverTop{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:8px;
}
.feverBar{
  height:10px;
  border-radius:999px;
  background: rgba(255,255,255,.10);
  overflow:hidden;
}
.feverFill{
  height:100%;
  width:0%;
  background: linear-gradient(90deg, var(--vio), var(--cyan), var(--gold));
  box-shadow: 0 0 18px rgba(0,240,255,.35);
}

/* ========== STAGE (FIXED PLAYFIELD) ========== */
.stage{
  position: fixed;                 /* ←重要：絶対に崩れない */
  top: calc(var(--safeT) + var(--hudH));
  left: 0;
  right: 0;
  bottom: calc(var(--safeB) + var(--btnH));
  z-index: 10;
  overflow: hidden;
}

/* canvas full stage */
.noteCanvas{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  z-index: 11;
  touch-action: manipulation;
}

/* 判定ライン（ターゲット位置と一致させる） */
.stage::after{
  content:"";
  position:absolute;
  left:50%;
  top: 78%;
  width:min(520px, 86vw);
  height:2px;
  transform: translate(-50%, -50%);
  background: linear-gradient(90deg, transparent, rgba(0,240,255,.78), transparent);
  opacity:.72;
  z-index: 12;
  pointer-events:none;
}

/* ========== TARGET ========== */
.targetRoot{
  position:absolute;
  left:50%;
  top: 78%;                         /* stage内で固定 */
  width:min(260px, 56vw);
  aspect-ratio: 1/1;
  transform: translate(-50%,-50%);
  z-index: 13;
  pointer-events:none;
  opacity:.96;
  filter: drop-shadow(0 0 18px rgba(0,240,255,.12));
}

.targetOuter, .targetCore, .targetHitRing, .scanLine{
  position:absolute;
  inset:0;
  border-radius:999px;
}

.targetOuter{
  background:
    radial-gradient(circle at 35% 30%, rgba(255,255,255,.12), transparent 55%),
    radial-gradient(circle at 60% 70%, rgba(0,240,255,.10), transparent 58%),
    conic-gradient(from 90deg,
      rgba(0,240,255,.0) 0 18%,
      rgba(0,240,255,.18) 18% 19%,
      rgba(230,201,107,.0) 19% 42%,
      rgba(230,201,107,.16) 42% 43%,
      rgba(156,60,255,.0) 43% 70%,
      rgba(156,60,255,.12) 70% 71%,
      rgba(0,240,255,.0) 71% 100%);
  border:1px solid rgba(255,255,255,.16);
  box-shadow:
    inset 0 0 26px rgba(0,240,255,.10),
    inset 0 0 18px rgba(230,201,107,.06);
  opacity:.92;
}

.targetCore{
  inset:28%;
  background:
    radial-gradient(circle at 35% 30%, rgba(255,255,255,.22), transparent 55%),
    radial-gradient(circle, rgba(0,240,255,.20), transparent 62%);
  border:1px solid rgba(0,240,255,.16);
  box-shadow: 0 0 22px rgba(0,240,255,.14);
  animation: corePulse 1.15s ease-in-out infinite;
}
@keyframes corePulse{
  0%,100%{ transform: scale(.98); opacity:.88; }
  50%{ transform: scale(1.05); opacity:1; }
}

.targetHitRing{
  inset:9%;
  border:1px dashed rgba(230,201,107,.22);
  opacity:.70;
}

.scanLine{
  background: conic-gradient(from 0deg, rgba(0,240,255,.0), rgba(0,240,255,.18), rgba(0,240,255,.0));
  mask: radial-gradient(circle, transparent 52%, #000 53%);
  opacity:.52;
  animation: scanSpin 2.6s linear infinite;
}
@keyframes scanSpin{ to{ transform: rotate(360deg); } }

/* form variants */
.targetRoot[data-form="eye"] .targetOuter{
  border-radius: 999px 999px 980px 980px;
}
.targetRoot[data-form="ankh"] .targetOuter{
  border-radius: 999px;
  /* iOSのmask-composite互換を考え、軽い表現に寄せる */
  background:
    radial-gradient(circle at 50% 26%, rgba(0,240,255,.14), transparent 32%),
    radial-gradient(circle at 50% 52%, rgba(230,201,107,.10), transparent 38%),
    conic-gradient(from 90deg, rgba(0,240,255,.0), rgba(0,240,255,.18), rgba(0,240,255,.0));
}
.targetRoot[data-form="pyramid"] .targetOuter{
  border-radius: 16px;
  clip-path: polygon(50% 6%, 92% 82%, 8% 82%);
}
.targetRoot[data-form="solar"] .targetOuter{
  background:
    radial-gradient(circle, rgba(255,210,110,.18), rgba(255,120,60,.08) 60%, transparent 72%),
    repeating-conic-gradient(from 0deg, rgba(255,210,110,.0) 0 10deg, rgba(255,210,110,.12) 10deg 11deg, rgba(255,210,110,.0) 11deg 20deg);
  mask: radial-gradient(circle, transparent 42%, #000 43%);
}

/* tier growth */
.targetRoot[data-tier="0"]{ filter: drop-shadow(0 0 16px rgba(0,240,255,.14)); }
.targetRoot[data-tier="1"]{ filter: drop-shadow(0 0 18px rgba(230,201,107,.16)); }
.targetRoot[data-tier="2"]{ filter: drop-shadow(0 0 20px rgba(156,60,255,.18)); }
.targetRoot[data-tier="3"]{ filter: drop-shadow(0 0 26px rgba(255,255,255,.14)); }

.targetRoot.hit{ animation: hitFlash .18s ease-out both; }
@keyframes hitFlash{
  0%{ transform: translate(-50%,-50%) scale(1); }
  70%{ transform: translate(-50%,-50%) scale(1.06); }
  100%{ transform: translate(-50%,-50%) scale(1.01); }
}

/* ========== JUDGE TEXT ========== */
.judgeText{
  position:absolute;
  left:50%;
  top: 63%;                         /* ターゲットより上 */
  transform: translate(-50%,-50%);
  z-index: 14;
  opacity:0;
  pointer-events:none;
  text-align:center;
  filter: drop-shadow(0 0 18px rgba(0,240,255,.16));
}
.judgeMain{
  display:block;
  font-size:28px;
  font-weight:1000;
  letter-spacing:.14em;
  text-shadow: 0 0 22px rgba(0,240,255,.18);
}
.judgeSub{
  display:block;
  margin-top:2px;
  font-size:12px;
  font-weight:900;
  letter-spacing:.28em;
  color: rgba(245,245,245,.78);
}
.judgeText.show{ animation: judgePop .42s ease-out both; }
@keyframes judgePop{
  0%{ opacity:0; transform: translate(-50%,-50%) scale(.92); }
  25%{ opacity:1; }
  100%{ opacity:0; transform: translate(-50%,-62%) scale(1.06); }
}

/* ========== PROTOCOL STACK（左上：邪魔しない） ========== */
.protocolStack{
  position:absolute;
  left:12px;
  top: 14px;
  z-index: 14;
  display:flex;
  flex-direction:column;
  gap:8px;
  opacity:0;
  transform: translateY(-6px);
  pointer-events:none;
}
.protocolStack.on{
  opacity:1;
  transform: translateY(0);
  transition: opacity .22s ease, transform .22s ease;
}
.protocolItem{
  width: min(260px, 64vw);
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(6,6,12,.40);
  backdrop-filter: blur(14px);
  display:flex;
  justify-content:space-between;
  align-items:center;
  box-shadow: 0 0 30px rgba(0,240,255,.10);
}
.pTag{
  font-size:11px;
  font-weight:1000;
  letter-spacing:.24em;
  color: rgba(230,201,107,.86);
}
.pText{
  font-size:12px;
  font-weight:900;
  letter-spacing:.14em;
  color: rgba(245,245,245,.78);
}
.protocolItem[data-state="idle"]{ opacity:.50; }
.protocolItem[data-state="on"]{
  opacity:1;
  border-color: rgba(230,201,107,.26);
  box-shadow: 0 0 34px rgba(230,201,107,.12), 0 0 38px rgba(0,240,255,.10);
}
.protocolItem[data-state="done"]{
  opacity:.92;
  border-color: rgba(0,240,255,.18);
}

/* ========== TRIAD CARDS（音ゲーの邪魔をしない：下側） ========== */
.arcanaTriad{
  position:absolute;
  left:50%;
  bottom: 10px;                     /* stage内の下 */
  transform: translateX(-50%);
  width:min(520px, 92vw);
  display:grid;
  grid-template-columns: 1fr;
  gap:10px;
  z-index: 14;
  opacity:0;
  pointer-events:none;
}

.arcanaTriad[data-visible="1"]{
  opacity:1;
  animation: triadIn .28s ease-out both;
}
@keyframes triadIn{
  0%{ transform: translateX(-50%) translateY(10px) scale(.98); opacity:0; }
  100%{ transform: translateX(-50%) translateY(0) scale(1); opacity:1; }
}

.cardSlot{
  position:relative;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.16);
  background: rgba(6,6,12,.42);
  backdrop-filter: blur(16px);
  overflow:hidden;
  box-shadow: 0 0 34px rgba(0,240,255,.10);
  min-height: 88px;                 /* 小さめ＝邪魔しない */
}

.cardGlow{
  position:absolute;
  inset:-40%;
  opacity:.55;
  filter: blur(26px);
  transform: rotate(18deg);
}
.cardGlow.compass{ background: radial-gradient(circle, rgba(0,240,255,.22), transparent 60%); }
.cardGlow.trigger{ background: radial-gradient(circle, rgba(255,120,60,.18), transparent 60%); }
.cardGlow.route{ background: radial-gradient(circle, rgba(156,60,255,.18), transparent 60%); }

.cardFace{ position:relative; padding:12px 12px; display:flex; flex-direction:column; gap:8px; }
.cardHead{ display:flex; justify-content:space-between; align-items:center; }
.cardRole{ font-size:11px; font-weight:1000; letter-spacing:.24em; color: rgba(245,245,245,.78); }
.cardSigil{ font-size:14px; color: rgba(230,201,107,.86); text-shadow: 0 0 16px rgba(230,201,107,.12); }
.cardName{ font-size:16px; font-weight:1000; letter-spacing:.08em; }
.cardMeta{ font-size:10px; font-weight:900; letter-spacing:.18em; color: rgba(245,245,245,.62); }

.absorbSeal{
  position:absolute;
  inset:0;
  opacity:0;
  background:
    radial-gradient(circle at 50% 50%, rgba(230,201,107,.18), transparent 62%),
    repeating-linear-gradient(90deg, rgba(230,201,107,.0) 0 10px, rgba(230,201,107,.10) 10px 11px, rgba(230,201,107,.0) 11px 22px);
  mix-blend-mode: screen;
}

.cardSlot.absorb{ animation: cardAbsorb .55s ease-in both; }
.cardSlot.absorb .absorbSeal{ opacity:1; animation: sealPulse .55s ease-in both; }

@keyframes sealPulse{ 0%{ filter: blur(10px); } 100%{ filter: blur(0px); } }
@keyframes cardAbsorb{
  0%{ opacity:1; transform: translateY(0) scale(1); }
  55%{ opacity:1; transform: translateY(2px) scale(.98); }
  100%{ opacity:0; transform: translateY(10px) scale(.94); }
}

/* ========== GOD MODE ========== */
.godMode{
  position:absolute;
  inset:0;
  z-index: 15;
  display:grid;
  place-items:center;
  opacity:0;
  pointer-events:none;
}
.godMode[data-on="1"]{
  opacity:1;
  animation: godIn .28s ease-out both;
}
@keyframes godIn{
  0%{ opacity:0; transform: scale(.98); }
  100%{ opacity:1; transform: scale(1); }
}
.godFrame{
  width:min(560px, 90vw);
  padding:18px 18px;
  border-radius:18px;
  border:1px solid rgba(255,255,255,.18);
  background:
    radial-gradient(circle at 30% 20%, rgba(255,210,110,.16), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,240,255,.12), transparent 55%),
    rgba(6,6,12,.58);
  backdrop-filter: blur(18px);
  box-shadow:
    0 0 56px rgba(255,210,110,.10),
    0 0 44px rgba(0,240,255,.14);
  text-align:center;
}
.godTitle{
  font-size:12px;
  font-weight:1000;
  letter-spacing:.28em;
  color: rgba(255,210,110,.90);
}
.godName{
  margin-top:8px;
  font-size:34px;
  font-weight:1000;
  letter-spacing:.10em;
  text-shadow: 0 0 24px rgba(255,210,110,.14);
}
.godLine{
  margin-top:8px;
  font-size:13px;
  font-weight:900;
  letter-spacing:.12em;
  color: rgba(245,245,245,.78);
}

/* ========== BOTTOM CONTROLS (FIXED) ========== */
.bottom{
  position: fixed;                 /* ←重要 */
  left:0;
  right:0;
  bottom:0;
  z-index: 30;
  display:flex;
  gap:10px;
  justify-content:center;
  padding: 10px 14px calc(var(--safeB) + 12px);
  pointer-events:auto;
}

.btn{
  border:1px solid rgba(255,255,255,.18);
  background: rgba(255,255,255,.07);
  color: var(--txt);
  padding: 12px 14px;
  border-radius: 14px;
  font-weight:900;
  letter-spacing:.06em;
}
.btn.primary{
  border-color: rgba(0,240,255,.35);
  background: rgba(0,240,255,.12);
  box-shadow: 0 0 20px rgba(0,240,255,.12);
}

/* ========== CENTER BANNER (overlay) ========== */
.centerBanner{
  position: fixed;
  inset:0;
  display:grid;
  place-items:center;
  z-index: 40;
  pointer-events:none;
  opacity:0;
  transform: scale(.96);
}
.centerBanner.show{
  opacity:1;
  transform: scale(1);
  transition: opacity .15s ease, transform .15s ease;
}
.bannerInner{
  width:min(520px, 88vw);
  padding:18px 18px;
  border-radius:18px;
  border: 1px solid rgba(255,255,255,.18);
  background: rgba(6,6,12,.58);
  backdrop-filter: blur(14px);
  text-align:center;
  box-shadow: 0 0 40px rgba(0,240,255,.18);
  position:relative;
  overflow:hidden;
}
.bannerInner::before{
  content:"";
  position:absolute;
  inset:-40%;
  background:
    repeating-linear-gradient(120deg,
      rgba(230,201,107,.0) 0 12px,
      rgba(230,201,107,.08) 12px 13px,
      rgba(230,201,107,.0) 13px 24px),
    radial-gradient(circle at 30% 20%, rgba(255,210,110,.14), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,240,255,.12), transparent 55%);
  opacity:.75;
  filter: blur(.2px);
  transform: rotate(6deg);
  mix-blend-mode: screen;
}
.bannerSmall{
  color: rgba(245,245,245,.74);
  font-weight:800;
  letter-spacing:.18em;
  font-size:12px;
}
.bannerTiny{
  margin-top:6px;
  color: rgba(245,245,245,.58);
  font-weight:900;
  letter-spacing:.20em;
  font-size:11px;
}
.bannerBig{
  margin:10px 0 4px;
  font-size:34px;
  font-weight:1000;
  letter-spacing:.08em;
  text-shadow:
    0 0 24px rgba(255,210,110,.14),
    0 0 14px rgba(0,240,255,.10);
}
.bannerSub{
  font-size:12px;
  font-weight:1000;
  letter-spacing:.22em;
  color: rgba(230,201,107,.82);
  text-shadow: 0 0 18px rgba(230,201,107,.10);
}

/* ========== FEVER ========== */
body.feverOn .bgVideo{
  opacity:.38;
  filter: saturate(1.38) contrast(1.10);
}
body.feverOn .app{
  animation: pulseGlow 1.2s ease-in-out infinite;
}
@keyframes pulseGlow{
  0%,100% { filter: drop-shadow(0 0 10px rgba(230,201,107,.10)); }
  50%     { filter: drop-shadow(0 0 22px rgba(0,240,255,.18)); }
}

/* ========== CENTER BURST CARD (existing) ========== */
.card{
  position:absolute;
  left:50%;
  top:50%;
  width: 120px;
  height: 170px;
  transform: translate(-50%, -50%) scale(.35) rotate(var(--rot, 0deg));
  border-radius: 14px;
  border: 1px solid rgba(255,255,255,.18);
  background:
    radial-gradient(circle at 30% 20%, rgba(0,240,255,.20), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(230,201,107,.18), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
  box-shadow:
    0 0 24px rgba(0,240,255,.16),
    0 0 44px rgba(156,60,255,.10);
  opacity:0;
  will-change: transform, opacity;
  z-index: 50;
}
.card::before{
  content: attr(data-title);
  position:absolute;
  left:10px;
  top:10px;
  font-size:12px;
  letter-spacing:.18em;
  color: rgba(245,245,245,.8);
}
.card::after{
  content:"";
  position:absolute;
  inset:10px;
  border-radius:10px;
  border: 1px solid rgba(0,240,255,.18);
  box-shadow: inset 0 0 22px rgba(0,240,255,.10);
}
@keyframes cardBurst{
  0%   { opacity:0; transform: translate(-50%,-50%) scale(.3) rotate(var(--rot,0deg)); }
  10%  { opacity:1; }
  60%  { opacity:1; transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(.95) rotate(calc(var(--rot,0deg) + 18deg)); }
  100% { opacity:0; transform: translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(1.05) rotate(calc(var(--rot,0deg) + 28deg)); }
}
.card.play{ animation: cardBurst .85s ease-out both; }

/* ========== SR only ========== */
.srOnly{
  position:absolute;
  width:1px; height:1px;
  overflow:hidden;
  clip: rect(0,0,0,0);
  white-space:nowrap;
  clip-path: inset(50%);
}

/* =========================
   GOD演出 追加パック（追記するだけでOK）
   - FEVER/GOD MODEを「神回」へ
   - 画面崩れなし（全部 pointer-events:none）
   - 既存の .feverOn / .godMode[data-on="1"] と連動
   ========================= */

/* ---------------------------------
   0) 変数追加（そのまま :root に追記OK）
--------------------------------- */
:root{
  --godA: rgba(255,255,255,.18);
  --godB: rgba(255,210,110,.22);
  --godC: rgba(0,240,255,.18);
  --godD: rgba(156,60,255,.14);

  --shake: 0px; /* 将来JSで揺れ強度入れる用（今は0） */
}

/* ---------------------------------
   1) GOD / FEVER 共通：画面全体の神気フィルター
--------------------------------- */
body.feverOn::before,
body.feverOn::after{
  content:"";
  position:fixed;
  inset:0;
  z-index: 4;                 /* mythLayer(2)より上、stage(10)より下 */
  pointer-events:none;
}

/* 神気の「光膜」 */
body.feverOn::before{
  background:
    radial-gradient(circle at 50% 40%, rgba(255,210,110,.10), transparent 58%),
    radial-gradient(circle at 30% 80%, rgba(0,240,255,.08), transparent 56%),
    radial-gradient(circle at 80% 75%, rgba(156,60,255,.06), transparent 60%),
    conic-gradient(from 180deg,
      rgba(255,210,110,.0) 0 20%,
      rgba(255,210,110,.10) 20% 22%,
      rgba(0,240,255,.0) 22% 44%,
      rgba(0,240,255,.08) 44% 46%,
      rgba(156,60,255,.0) 46% 68%,
      rgba(156,60,255,.06) 68% 70%,
      rgba(255,210,110,.0) 70% 100%);
  mix-blend-mode: screen;
  opacity: .9;
  filter: blur(.2px);
  animation: godAuras 1.4s ease-in-out infinite;
}

/* 神紋の「微粒子ノイズ」 */
body.feverOn::after{
  background:
    repeating-linear-gradient(115deg,
      rgba(255,255,255,.00) 0 9px,
      rgba(255,255,255,.03) 9px 10px,
      rgba(255,255,255,.00) 10px 18px),
    radial-gradient(circle at 50% 50%, rgba(255,255,255,.06), transparent 60%);
  mix-blend-mode: overlay;
  opacity: .35;
  animation: godNoise 1.2s linear infinite;
}

@keyframes godAuras{
  0%,100%{ transform: scale(1); filter: blur(.2px); }
  50%{ transform: scale(1.03); filter: blur(.4px); }
}
@keyframes godNoise{
  to{ transform: translate3d(-8px, 6px, 0); }
}

/* ---------------------------------
   2) GOD MODE：太陽紋章・走査・祝福フレア
   （.godMode は z-index:15 なので、その中で演出を完結）
--------------------------------- */

/* godModeの背面に「巨大紋章」 */
.godMode::before{
  content:"";
  position:absolute;
  inset:-18%;
  background:
    radial-gradient(circle at 50% 50%, rgba(255,210,110,.18), transparent 55%),
    repeating-conic-gradient(from 0deg,
      rgba(255,210,110,.0) 0 8deg,
      rgba(255,210,110,.12) 8deg 9deg,
      rgba(255,210,110,.0) 9deg 16deg),
    radial-gradient(circle at 50% 50%, rgba(0,240,255,.10), transparent 62%);
  mask: radial-gradient(circle, transparent 34%, #000 35%);
  mix-blend-mode: screen;
  opacity:0;
  transform: scale(.94);
  filter: blur(.4px);
  pointer-events:none;
}

.godMode[data-on="1"]::before{
  opacity:.92;
  animation: sigilBloom .48s ease-out both, sigilSpin 7s linear infinite;
}

@keyframes sigilBloom{
  0%{ opacity:0; transform: scale(.84); }
  65%{ opacity:1; transform: scale(1.02); }
  100%{ opacity:.92; transform: scale(.98); }
}
@keyframes sigilSpin{
  to{ transform: scale(.98) rotate(360deg); }
}

/* 神の走査線（上から落ちる） */
.godMode::after{
  content:"";
  position:absolute;
  left:-10%;
  right:-10%;
  top:-20%;
  height:38%;
  background:
    linear-gradient(180deg,
      rgba(255,255,255,.00),
      rgba(255,210,110,.10),
      rgba(0,240,255,.08),
      rgba(255,255,255,.00));
  opacity:0;
  mix-blend-mode: screen;
  filter: blur(0px);
  transform: translateY(-40%);
  pointer-events:none;
}
.godMode[data-on="1"]::after{
  opacity:.8;
  animation: scanDrop .95s ease-out infinite;
}
@keyframes scanDrop{
  0%{ transform: translateY(-65%); }
  75%{ opacity:.85; }
  100%{ transform: translateY(220%); opacity:0; }
}

/* ---------------------------------
   3) GOD FRAME：縁取りが「生きる」
--------------------------------- */
.godFrame{
  position:relative;
  overflow:hidden;
}

/* 祝福の縁（発光リム） */
.godFrame::before{
  content:"";
  position:absolute;
  inset:-2px;
  border-radius:20px;
  padding:2px;
  background:
    conic-gradient(from 180deg,
      rgba(255,210,110,.0),
      rgba(255,210,110,.55),
      rgba(0,240,255,.40),
      rgba(156,60,255,.28),
      rgba(255,210,110,.55),
      rgba(255,210,110,.0));
  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  opacity:0;
  pointer-events:none;
  filter: blur(.3px);
}

/* 内側の星砂 */
.godFrame::after{
  content:"";
  position:absolute;
  inset:-30%;
  background:
    radial-gradient(circle at 30% 20%, rgba(255,255,255,.06), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(0,240,255,.07), transparent 58%),
    radial-gradient(circle at 50% 50%, rgba(255,210,110,.08), transparent 60%),
    repeating-linear-gradient(120deg,
      rgba(255,210,110,.00) 0 12px,
      rgba(255,210,110,.06) 12px 13px,
      rgba(255,210,110,.00) 13px 24px);
  mix-blend-mode: screen;
  opacity:0;
  transform: rotate(6deg);
  pointer-events:none;
}

.godMode[data-on="1"] .godFrame::before{
  opacity:1;
  animation: rimSpin 2.8s linear infinite;
}
.godMode[data-on="1"] .godFrame::after{
  opacity:.9;
  animation: sandFloat 1.6s ease-in-out infinite;
}

@keyframes rimSpin{
  to{ transform: rotate(360deg); }
}
@keyframes sandFloat{
  0%,100%{ transform: translate3d(0,0,0) rotate(6deg); filter: blur(.0px); }
  50%{ transform: translate3d(0,-6px,0) rotate(8deg); filter: blur(.3px); }
}

/* タイトル/名前の「神格グリッチ（上品）」 */
.godName{
  position:relative;
}
.godMode[data-on="1"] .godName{
  animation: godTextGlow 1.1s ease-in-out infinite;
}
@keyframes godTextGlow{
  0%,100%{ text-shadow: 0 0 24px rgba(255,210,110,.14), 0 0 14px rgba(0,240,255,.12); }
  50%{ text-shadow: 0 0 34px rgba(255,210,110,.20), 0 0 22px rgba(156,60,255,.12); }
}

/* ---------------------------------
   4) TARGET：FEVER中は「太陽眼」へ寄せる
--------------------------------- */
body.feverOn .targetOuter{
  border-color: rgba(255,210,110,.28);
  box-shadow:
    inset 0 0 34px rgba(255,210,110,.12),
    inset 0 0 22px rgba(0,240,255,.10);
  animation: targetHalo 1.2s ease-in-out infinite;
}
@keyframes targetHalo{
  0%,100%{ filter: drop-shadow(0 0 18px rgba(255,210,110,.14)); }
  50%{ filter: drop-shadow(0 0 30px rgba(0,240,255,.16)); }
}

body.feverOn .scanLine{
  opacity:.68;
  animation-duration: 1.8s;
}

/* HOLD中：核が“封印陣”みたいに */
.targetRoot.holding .targetCore{
  border-color: rgba(255,210,110,.22);
  box-shadow:
    0 0 28px rgba(255,210,110,.18),
    0 0 22px rgba(0,240,255,.12);
}

/* ---------------------------------
   5) CENTER BANNER：GOD時だけ「降臨リップル」
--------------------------------- */
.centerBanner.show .bannerInner{
  position:relative;
}
body.feverOn .centerBanner.show .bannerInner{
  animation: bannerRipple .52s ease-out both;
}
@keyframes bannerRipple{
  0%{ transform: translateZ(0) scale(.98); box-shadow: 0 0 18px rgba(255,210,110,.10); }
  55%{ transform: translateZ(0) scale(1.01); box-shadow: 0 0 52px rgba(255,210,110,.16), 0 0 36px rgba(0,240,255,.14); }
  100%{ transform: translateZ(0) scale(1); box-shadow: 0 0 40px rgba(0,240,255,.18); }
}

/* ---------------------------------
   6) TRIAD：吸収時に「光の糸」が走る（邪魔しない）
--------------------------------- */
.cardSlot.absorb::after{
  content:"";
  position:absolute;
  left:-20%;
  top:0;
  width:40%;
  height:100%;
  background:
    linear-gradient(90deg,
      rgba(255,255,255,.00),
      rgba(255,210,110,.16),
      rgba(0,240,255,.12),
      rgba(255,255,255,.00));
  mix-blend-mode: screen;
  transform: skewX(-18deg) translateX(-60%);
  opacity:.0;
  pointer-events:none;
  animation: threadSweep .55s ease-out both;
}
@keyframes threadSweep{
  0%{ opacity:0; transform: skewX(-18deg) translateX(-70%); }
  25%{ opacity:1; }
  100%{ opacity:0; transform: skewX(-18deg) translateX(420%); }
}

/* ---------------------------------
   7) 安全策：重い環境で自動OFF（省電力）
--------------------------------- */
@media (prefers-reduced-motion: reduce){
  body.feverOn::before,
  body.feverOn::after,
  .godMode::before,
  .godMode::after,
  .godFrame::before,
  .godFrame::after,
  body.feverOn .targetOuter,
  body.feverOn .scanLine{
    animation: none !important;
  }
}
