<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>詩韻 Shion — 言葉で魂を救う Code｜無料タロット（詩・韻・祈）</title>
  <meta name="description" content="無料タロットで“詩・韻・祈”。詩韻 Shion の思想（言葉で魂を救う Code）に基づくリーディング。恋愛・復縁・連絡・進路の悩みに。">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Cormorant+Garamond:wght@400;600&display=swap" rel="stylesheet">
  <!-- 外部CSS（同じ階層に shion-tarot.css を置く） -->
  <link rel="stylesheet" href="shion-tarot.css">
  <meta property="og:type" content="website">
  <meta property="og:title" content="詩韻 Shion — 言葉で魂を救う Code｜無料タロット（詩・韻・祈）">
  <meta property="og:description" content="“詩・韻・祈”で読む、思想連動タロット。儀式（星詠リチュアル）→展開→濃密リーディング→次の一歩へ。">
  <meta property="og:image" content="assets/ogp.jpg">
  <meta property="og:url" content="./">
</head>
<body>

  <!-- 星砂（離脱率低減の常時ゆらぎ） -->
  <div class="stardust" aria-hidden="true"></div>

  <!-- ===== ヒーロー：世界観の宣言 ===== -->
  <section class="hero" id="hero">
    <div class="hero__bg" aria-hidden="true"></div>
    <div class="hero__veil" aria-hidden="true"></div>
    

    <div class="hero__inner">
      <h1 class="hero__title">言葉で魂を救う<span class="hero__code">Code</span></h1>
      <p class="hero__subtitle">占い × 思想 ――<br> 詩（Poem）・韻（Rhythm）・祈（Prayer）で、<br>あなたの現実を編み直す。</p>

      <!-- 詩韻語：思想を情緒で橋渡し -->
      <p class="shion-poem">―― 言葉は光。<br>韻はその行方。祈りが、それを結ぶ。</p>

      <button id="startRitualBtn" class="btn-primary" type="button" aria-label="星詠リチュアルを始める">はじめる（星詠リチュアル）</button>
    </div>

    <!-- BGM（タップ時に起動） -->
    <audio id="bgm" src="assets/sound/temple-ambient.mp3" preload="auto" loop playsinline></audio>
  </section>

  <!-- ===== 星詠リチュアル：儀式導入 → タロットへ ===== -->
  <section id="ritual" class="ritual hidden" aria-live="polite" aria-atomic="true">
    <div class="ritual__glow" aria-hidden="true"></div>
    <p class="ritual__line">星の声が、あなたの言葉に触れる。</p>
    <p class="ritual__line">息を整えて――目を閉じ、一度だけ願いを呼ぶ。</p>
    <p class="ritual__line">いま、展く。詩・韻・祈。</p>
  </section>

  <!-- ===== タロット本編 ===== -->
  <main id="main" class="main hidden" aria-labelledby="readingTitle">
    <section class="spread" aria-label="タロット展開">
      <h2 id="readingTitle" class="sr-only">詩・韻・祈 の三枚展開</h2>

      <div class="spread__labels" aria-hidden="true">
        <div class="label">詩</div>
        <div class="label">韻</div>
        <div class="label">祈</div>
      </div>

      <div class="spread__cards">
        <div class="card" data-idx="0" aria-label="詩のカード">
          <div class="card__inner">
            <div class="card__face card__back"></div>
            <div class="card__face card__front" id="card0" role="img" aria-label="詩のカード 表面画像"></div>
          </div>
        </div>
        <div class="card" data-idx="1" aria-label="韻のカード">
          <div class="card__inner">
            <div class="card__face card__back"></div>
            <div class="card__face card__front" id="card1" role="img" aria-label="韻のカード 表面画像"></div>
          </div>
        </div>
        <div class="card" data-idx="2" aria-label="祈のカード">
          <div class="card__inner">
            <div class="card__face card__back"></div>
            <div class="card__face card__front" id="card2" role="img" aria-label="祈のカード 表面画像"></div>
          </div>
        </div>
      </div>

      <div class="tap-hint" id="tapHint"><div class="tap-hint__pill">カードを順にタップ</div></div>
      <!-- 効果光（クリック不可） -->
      <div class="peel" id="peel" aria-hidden="true"></div>
    </section>

    <!-- ===== 濃密リーディング（離脱防止の本丸） ===== -->
    <section class="reading section" id="reading">
      <h3 class="section__title">詩・韻・祈 のリーディング</h3>
      <div class="reading__grid">
        <article class="reading__item">
          <div class="reading__head">詩（Poem）</div>
          <div class="reading__body" id="body0">カードを開くと、ここに“詩”が現れます。</div>
        </article>
        <article class="reading__item">
          <div class="reading__head">韻（Rhythm）</div>
          <div class="reading__body" id="body1">カードを開くと、ここに“韻”が現れます。</div>
        </article>
        <article class="reading__item">
          <div class="reading__head">祈（Prayer）</div>
          <div class="reading__body" id="body2">カードを開くと、ここに“祈”が現れます。</div>
        </article>
      </div>

      <p class="closing-line">大丈夫だよ。言葉は、あなたの光だから。</p>

      <nav class="cta">
        <a class="cta__btn" href="#" id="retry">もう一度占う</a>
        <a class="cta__btn cta__btn--line" href="https://lin.ee/9RBqOl4" target="_blank" rel="noopener">LINEで個人鑑定</a>
        <a class="cta__btn cta__btn--tiktok" href="https://www.tiktok.com/@your_tiktok" target="_blank" rel="noopener">TikTok配信を見る</a>
        <a class="cta__btn cta__btn--note" href="https://note.com/your_note/m/magazine" target="_blank" rel="noopener">詩韻思想を読む</a>
      </nav>
    </section>
  </main>

  <!-- カード効果音（軽め） -->
  <audio id="flipSe" src="https://freesound.org/data/previews/351/351408_5665338-lq.mp3" preload="auto"></audio>

  <!-- ====== Script（ページ専用） ====== -->
  <script>
  // ---------- BGM（iOS対策：ユーザー操作で起動） ----------
  const bgm = document.getElementById('bgm');
  function kickBgm(){
    if(!bgm) return;
    try {
      bgm.volume = 0.55;
      const p = bgm.play();
      if (p && typeof p.catch === 'function') p.catch(()=>{ /* 端末がブロック中 */ });
    } catch(e){}
  }

  // ---------- データ：メジャー22 & 画像（Wikipedia安定URL） ----------
  const cardFrontImages = [
    'https://upload.wikimedia.org/wikipedia/commons/d/de/RWS_Tarot_00_Fool.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/d/d1/RWS_Tarot_01_Magician.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/8/88/RWS_Tarot_02_High_Priestess.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/d/d2/RWS_Tarot_03_Empress.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/c/c3/RWS_Tarot_04_Emperor.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/8/8d/RWS_Tarot_05_Hierophant.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/d/d5/RWS_Tarot_06_Lovers.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/9/9b/RWS_Tarot_07_Chariot.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/f/f5/RWS_Tarot_08_Strength.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/4/4d/RWS_Tarot_09_Hermit.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/3/3c/RWS_Tarot_10_Wheel_of_Fortune.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/e/e0/RWS_Tarot_11_Justice.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/2/2b/RWS_Tarot_12_Hanged_Man.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/d/d7/RWS_Tarot_13_Death.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/f/f8/RWS_Tarot_14_Temperance.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/5/55/RWS_Tarot_15_Devil.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/5/53/RWS_Tarot_16_Tower.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/d/db/RWS_Tarot_17_Star.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/7/7f/RWS_Tarot_18_Moon.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/1/17/RWS_Tarot_19_Sun.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/d/dd/RWS_Tarot_20_Judgement.jpg',
    'https://upload.wikimedia.org/wikipedia/commons/f/ff/RWS_Tarot_21_World.jpg'
  ];

  const majorArcana = [
    { name:'The Fool',        upright:'純粋な始まりの風、冒険の翼を広げて。',  reversed:'無謀な跳躍、影に潜む落とし穴。', idx:0 },
    { name:'The Magician',    upright:'意志の炎が現実を紡ぎ、創造の河を流す。',  reversed:'幻の鏡、欺瞞の霧に包まれて。',    idx:1 },
    { name:'The High Priestess', upright:'内なる声のささやき、月の光が導く道。', reversed:'失われた均衡、抑圧された魂の叫び。', idx:2 },
    { name:'The Empress',     upright:'豊穣の大地、母なる愛の抱擁。',            reversed:'枯れた花、創造の停滞。',          idx:3 },
    { name:'The Emperor',     upright:'秩序の玉座、力強い統治の剣。',              reversed:'暴君の影、支配の崩壊。',          idx:4 },
    { name:'The Hierophant',  upright:'伝統の灯、教えの道標。',                    reversed:'硬直した信仰、自由の抑圧。',      idx:5 },
    { name:'The Lovers',      upright:'運命の交差、心の選択。',                    reversed:'迷いの分岐、愛の試練。',          idx:6 },
    { name:'The Chariot',     upright:'勝利の戦車、意志の疾走。',                  reversed:'方向を見失う馬車。',              idx:7 },
    { name:'Strength',        upright:'内なる獅子、優しさの力。',                  reversed:'弱さの咆哮、自己不信。',          idx:8 },
    { name:'The Hermit',      upright:'孤独の灯台、魂の探求。',                    reversed:'孤立の闇、導きを拒む。',          idx:9 },
    { name:'Wheel of Fortune',upright:'運命の輪、巡る星の流れ。',                  reversed:'停滞の歯車、予期せぬ転落。',      idx:10 },
    { name:'Justice',         upright:'天秤の裁き、真実の剣。',                    reversed:'不正の影、偏った判断。',          idx:11 },
    { name:'The Hanged Man',  upright:'逆さの悟り、犠牲の光。',                    reversed:'停滞の苦しみ、視野の狭さ。',      idx:12 },
    { name:'Death',           upright:'終わりと始まり、変容の蝶。',                reversed:'変化への恐怖、過去の亡霊。',      idx:13 },
    { name:'Temperance',      upright:'調和の天使、バランスの流れ。',              reversed:'極端な揺らぎ、衝突の炎。',        idx:14 },
    { name:'The Devil',       upright:'鎖の誘惑、欲望の檻。',                      reversed:'解放の鍵、束縛からの脱出。',      idx:15 },
    { name:'The Tower',       upright:'崩壊の雷、覚醒の衝撃。',                    reversed:'破壊の予兆、避けられない危機。',  idx:16 },
    { name:'The Star',        upright:'希望の星、癒しの水。',                      reversed:'失われた光、絶望の夜。',          idx:17 },
    { name:'The Moon',        upright:'幻想の月、潜在意識の海。',                  reversed:'真実の光、欺瞞の霧。',            idx:18 },
    { name:'The Sun',         upright:'輝く太陽、生命の喜び。',                    reversed:'曇った陽光、一時的な幸福。',      idx:19 },
    { name:'Judgement',       upright:'覚醒の喇叭、再生の炎。',                    reversed:'自己否定、過去の重荷。',          idx:20 },
    { name:'The World',       upright:'調和の円舞、成就の星。',                    reversed:'未完の旅、閉ざされた門。',        idx:21 }
  ];

  // ---------- 要素参照 ----------
  const startBtn  = document.getElementById('startRitualBtn');
  const ritualSec = document.getElementById('ritual');
  const mainSec   = document.getElementById('main');
  const peel      = document.getElementById('peel');
  const tapHint   = document.getElementById('tapHint');
  const readingEl = document.getElementById('reading');
  const retryBtn  = document.getElementById('retry');
  const flipSe    = document.getElementById('flipSe');

  const cardEls   = document.querySelectorAll('.card');
  const fronts    = [document.getElementById('card0'), document.getElementById('card1'), document.getElementById('card2')];

  const bodies = [
    document.getElementById('body0'),
    document.getElementById('body1'),
    document.getElementById('body2')
  ];
  const defaultBodies = [
    'カードを開くと、ここに“詩”が現れます。',
    'カードを開くと、ここに“韻”が現れます。',
    'カードを開くと、ここに“祈”が現れます。'
  ];

  // ---------- 状態 ----------
  let selected = [];     // 今回の3枚
  let opened = 0;        // めくった枚数

  function drawThree(){
    // 毎回新しい乱数で3枚（被りなし）
    const pool = [...majorArcana];
    const picks = [];
    for(let i=0;i<3;i++){
      const r = crypto.getRandomValues(new Uint32Array(1))[0] % pool.length;
      picks.push(pool.splice(r,1)[0]);
    }
    return picks;
  }

  function resetView(){
    opened = 0;
    // 表示リセット
    bodies.forEach((el, i)=> el.textContent = defaultBodies[i]);
    document.querySelector('.reading')?.classList.remove('is-active');
    tapHint.style.opacity = 1;

    // カード見た目リセット
    cardEls.forEach((el,i)=>{
      el.classList.remove('is-flipped');
      el.style.pointerEvents = 'auto';
      fronts[i].style.backgroundImage = 'none';
    });
  }

  function beginReading(){
    // 新しい抽選
    selected = drawThree();
    resetView();
  }

  function beginRitual(){
    // BGM起動
    kickBgm();

    // 儀式表示 → 2秒後に本編へ
    ritualSec.classList.remove('hidden');
    setTimeout(()=>{
      ritualSec.classList.add('hidden');
      mainSec.classList.remove('hidden');

      // ふわっと出す
      peel.classList.add('is-run');
      peel.addEventListener('animationend', ()=> peel.classList.remove('is-run'), {once:true});

      // 抽選開始
      beginReading();

      // スクロール
      mainSec.scrollIntoView({behavior:'smooth', block:'start'});
    }, 2000);
  }

  // カードめくり
  function onFlip(idx){
    const cardEl = cardEls[idx];
    if(cardEl.classList.contains('is-flipped') || opened>=3) return;

    const data = selected[idx];
    const isReversed = (crypto.getRandomValues(new Uint32Array(1))[0] % 2) === 1;

    // 画像セット
    const imgUrl = cardFrontImages[data.idx];
    fronts[idx].style.backgroundImage = `url('${imgUrl}')`;

    // SE
    try { flipSe.currentTime = 0; flipSe.play(); } catch(e){}

    // めくり
    cardEl.classList.add('is-flipped');
    opened++;

    // リーディング反映（濃密・簡潔）
    const label = ['【詩】','【韻】','【祈】'][idx];
    const text  = isReversed ? data.reversed : data.upright;
    bodies[idx].innerHTML =
      `<strong>${label}</strong> 《${data.name}》${isReversed?'（逆位置）':'（正位置）'}<br>${text}`;

    // 3枚すべて開いたらCTAへ
    if(opened===3){
      tapHint.style.opacity = 0;
      cardEls.forEach(c=> c.style.pointerEvents='none');
      document.querySelector('.reading').classList.add('is-active');
      readingEl.scrollIntoView({behavior:'smooth', block:'start'});
    }
  }

  // もう一度占う（毎回新抽選）
  function onRetry(e){
    e.preventDefault();
    document.getElementById('hero').scrollIntoView({behavior:'smooth'});
    setTimeout(()=>{
      beginReading(); // 新しい三枚を抽選
    }, 600);
  }

  // 監視：初期バインド
  window.addEventListener('load', ()=>{
    // カードクリック
    cardEls.forEach((el)=> el.addEventListener('click', ()=> onFlip(Number(el.dataset.idx)), {passive:true}));
    // はじめる
    startBtn.addEventListener('click', beginRitual, {passive:true});
    // リトライ
    retryBtn.addEventListener('click', onRetry, false);
    // 最初の軽いスクロール誘導
    setTimeout(()=>{ document.querySelector('.hero__veil').classList.add('is-on'); }, 350);
  });

  // タッチでもBGMキック（保険）
  window.addEventListener('touchstart', function once(){ kickBgm(); window.removeEventListener('touchstart', once, {passive:true}); }, {passive:true, once:true});
  </script>
</body>
</html>
