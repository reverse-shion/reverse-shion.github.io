/* =========================================================
   Re:verse Shion — Mini Reading (3-cards) scoped stylesheet
   Version: 2025-11-02 mobile-3fit
   役割：#mini-reading セクション専用（UI・カード反転・結果表示）
   ポイント：
   - スマホでも横3枚が必ず画面内に収まる（overflowなし）
   - カード名（.tbm-name）は flip 後にフェード表示
   ========================================================= */

.tb-mini{
  --ink:#26263a;
  --muted:#727297;
  --halo:#ffd76f80;
  --accent:#7e66ff;
  --panel:#ffffffcc;
  --r:16px;

  /* ===== 変数：カード裏面（グローバル） ===== */
:root{
  --card-back-url: image-set(
    url("/assets/images/tarot/tarot_back_1024x1536.jpg") 1x,
    url("/assets/images/tarot/tarot_back_2x_2048x3072.jpg") 2x
  );
}
   /* 裏面：変数をそのまま使う */
.tbm-face.back{
  background-image: var(--card-back-url);
  background-repeat: no-repeat;
  background-position: center;
  background-size: cover;
}

.tbm-face.front{
  background-image: var(--front-url);
  background-size: cover;
  background-position: center;
}
  color:var(--ink);
}
.tb-mini *{ box-sizing:border-box }

/* ===== Head ===== */
.tb-mini .tbm-head{
  padding:20px 16px 8px;
  background:linear-gradient(#fff,#fff8);
  backdrop-filter:saturate(140%) blur(6px);
  border-radius:18px
}
.tb-mini .tbm-head h2{ margin:0 0 6px; font-size:20px }
.tb-mini .tbm-lead{ margin:0 0 12px; color:var(--muted); font-size:14px }
.tb-mini .tbm-actions{ display:flex; gap:12px; flex-wrap:wrap }
.tb-mini .tbm-btn{
  appearance:none; border:none; border-radius:999px; padding:10px 16px;
  background:#eee; color:#333; font-weight:700; cursor:pointer; transition:transform .05s ease
}
.tb-mini .tbm-btn.primary{
  background:linear-gradient(135deg,#ffb3cf,#ffd76f 60%,#ffe8a8);
  box-shadow:0 8px 24px -10px var(--halo)
}
.tb-mini .tbm-btn:active{ transform:translateY(1px) }

/* ===== Spread：スマホでも横3枚固定・画面内に収める ===== */
/* フレックスで3枠をvw基準幅に。gap含め 96〜98vw に収まる設計 */
.tb-mini .tbm-spread{
  display:flex; justify-content:center; align-items:flex-start; gap:min(3.2vw,14px);
  width:100%; margin:18px auto 28px; padding:0 min(3.2vw,14px);
  overflow-x:hidden;
}

/* 1枠（カード＋名前＋ヒント）幅をvwで統一 → 3枠で必ず収まる */
.tb-mini .tbm-slot{
  width: clamp(100px, 30vw, 132px);  /* ← 横3枚＋gapでも100%以内 */
  background:var(--panel); border:1px solid #eee; border-radius:20px; padding:12px;
  box-shadow:0 10px 30px -20px rgba(0,0,0,.2);
  display:flex; flex-direction:column; align-items:center; gap:8px;
}
.tb-mini .tbm-title{ margin:0 0 4px; font-size:14px; color:var(--muted) }

/* ===== Card core（サイズは枠幅に追随、拡大アニメなし） ===== */
.tb-mini .tbm-card{
  position:relative; width:100%; aspect-ratio:2/3; border-radius:14px; cursor:pointer;
  perspective:1000px; outline:none; overflow:hidden;
  transition: box-shadow .35s ease, filter .35s ease;  /* ← transformは使わない */
  box-shadow: 0 8px 22px rgba(0,0,0,.18);
}
.tb-mini .tbm-card:hover{ box-shadow: 0 12px 28px rgba(126,102,255,.28) }

.tb-mini .tbm-card-inner{
  position:absolute; inset:0; transform-style:preserve-3d; border-radius:inherit;
  transition: transform .6s cubic-bezier(.2,.8,.2,1)
}
.tb-mini .tbm-face{
  position:absolute; inset:0; border-radius:inherit; backface-visibility:hidden;
  background-size:cover; background-position:center;
  box-shadow:0 10px 30px -12px rgba(0,0,0,.35)
}
/* 裏面（常時表示） */
.tb-mini .tbm-face.back{ background-image: var(--card-back-url) }
/* 表面（JSで --front-url を付与） */
.tb-mini .tbm-face.front{ transform: rotateY(180deg); background-image: var(--front-url, none) }

/* 反転（サイズ不変） */
.tb-mini .tbm-card.flipped .tbm-card-inner{ transform: rotateY(180deg) }
.tb-mini .tbm-card:focus-visible{ box-shadow:0 0 0 3px #c9b4ff80 }

/* ===== Tap演出（光・リップル） ===== */
.tb-mini .tbm-card.aura-pop{ animation:tbmAura .6s ease-out }
@keyframes tbmAura{
  0%{box-shadow:0 0 0 0 rgba(126,102,255,.00),0 0 0 0 rgba(255,215,111,.00)}
  50%{box-shadow:0 0 24px 8px rgba(126,102,255,.35),0 0 60px 18px rgba(255,215,111,.25)}
  100%{box-shadow:0 2px 24px -10px rgba(0,0,0,.35)}
}
.tb-mini .tbm-card::after{
  content:""; position:absolute; inset:0; border-radius:inherit; pointer-events:none;
  background:radial-gradient(circle at var(--tap-x,50%) var(--tap-y,50%),
    rgba(255,255,255,.55) 0%, rgba(255,215,111,.45) 20%, rgba(126,102,255,.35) 40%, rgba(126,102,255,.00) 60%);
  opacity:0; transform:scale(.6);
}
.tb-mini .tbm-card.ripple::after{ animation:tbmRipple .7s ease-out }
@keyframes tbmRipple{
  0%{opacity:0;transform:scale(.6)}
  10%{opacity:.85}
  60%{opacity:.45}
  100%{opacity:0;transform:scale(2.2)}
}

/* ===== カード名は“めくってから”表示 ===== */
.tb-mini .tbm-name{
  font-weight:800; font-size:13.5px; letter-spacing:.02em;
  color:#5a4a86; margin:2px 0 0; min-height:1.6em; text-align:center;
  opacity:0; visibility:hidden; transform: translateY(2px);
  transition: opacity .22s ease, transform .22s ease, visibility .22s linear;
}
/* .tbm-card の直後 or 同じコンテナ内の後続要素に対応 */
.tb-mini .tbm-card.flipped + .tbm-name,
.tb-mini .tbm-card.flipped ~ .tbm-name{
  opacity:1; visibility:visible; transform: translateY(0);
}

/* ヒントは常時表示（要望どおり） */
.tb-mini .tbm-hint{
  margin:6px 2px 0; font-size:13.5px; min-height:2.2em; color:#454562; text-align:center
}

/* ===== Result（詩／韻／祈） ===== */
#readingResult{ margin-top:22px }
#readingResult .result-grid{
  display:grid; gap:14px; max-width:980px; margin:16px auto 0;
}
@media (min-width:720px){ #readingResult .result-grid{ grid-template-columns:repeat(3,1fr) } }
#readingResult .result-item{
  background: linear-gradient(180deg, #ffffff0b, #00000006);
  border:1px solid #FFFFFF26; border-radius:14px; padding:12px 14px;
  box-shadow:0 8px 18px rgba(0,0,0,.12)
}
#readingResult .result-item .badge{
  display:inline-block; font-size:12px; color:#201630; background:#e9deff;
  padding:2px 8px; border-radius:999px; margin-bottom:6px; font-weight:800;
}
#readingResult .result-item .r-title{ margin:.2em 0; font-size:17px; color:#503080; font-weight:800 }
#readingResult .result-item .r-text{ margin:0; color:#3a3058; line-height:1.85; font-size:14.5px }

/* ===== Motion Safety ===== */
@media (prefers-reduced-motion: reduce){
  .tb-mini .tbm-card-inner{ transition:none }
  .tb-mini .tbm-card.aura-pop, .tb-mini .tbm-card.ripple{ animation:none }
}
