/* ===== Tokens ===== */
:root{
  --ink:#e9e9ff;
  --bg:#0b0814;
  --lav:#bfaeff;
  --gold:#ffd76f;
  --glass:#ffffff1a;

  /* カード画像（JSで上書きも可） */
  --card-back-url: url('assets/tarot/back.png');
}

/* ===== Base ===== */
*{ box-sizing:border-box }
html,body{ height:100% }
body{
  margin:0; color:var(--ink); background:radial-gradient(1200px 800px at 50% -20%, #2a1b4a, transparent 60%),
                                 radial-gradient(1400px 1000px at 50% 120%, #0e0a22, #070513 55%);
  font-family: "Noto Sans JP", system-ui, sans-serif;
}
h1{ font-size:clamp(20px,6vw,40px); margin:24px 0 8px; letter-spacing:.06em }
.wrap{ max-width:960px; margin:0 auto; padding:20px }
.wish{ display:block; margin:8px 0 16px }
.wish input{ width:min(720px,100%); padding:12px 14px; border-radius:12px; border:1px solid #3b3560; background:#110d22; color:var(--ink) }

.actions{ margin:10px 0 18px }
.btn{
  appearance:none; border:none; cursor:pointer;
  padding:12px 18px; border-radius:999px; color:#1a1333; background:linear-gradient(135deg,#f7e9b0,#ffd76f);
  box-shadow:0 10px 26px #0008, inset 0 1px 0 #fff7;
}
.btn-primary{ font-weight:700 }
.controls{ display:flex; gap:10px; margin-top:16px }

/* ===== Deck ===== */
.deck{
  display:flex; justify-content:center; align-items:center; gap:clamp(10px,3vw,22px);
  min-height:34vh; perspective:1200px;
}

/* カード本体：幅は画面の約1/9〜1/6の範囲で自動 */
.card{
  width:clamp(88px,18vw,140px); aspect-ratio: 2 / 3;
  position:relative; border-radius:14px; border:1px solid #0000; transform-style:preserve-3d;
  opacity:0; transform:translateY(24px) scale(.94); transition:transform .5s ease, opacity .5s ease;
  background:#0d0a19;
  box-shadow:0 18px 46px rgba(0,0,0,.55), 0 0 0 1px #ffffff10 inset;
}
.card.show{ opacity:1; transform:translateY(0) scale(1) }

.face{
  position:absolute; inset:0; border-radius:14px; backface-visibility:hidden;
  background-size:cover; background-position:center;
}
.face.back{ background-image:var(--card-back-url) }
.face.front{ background-image:var(--face-url); transform:rotateY(180deg) }

.face-label{
  position:absolute; left:8px; bottom:8px; font:600 12px/1.2 system-ui, sans-serif;
  padding:6px 8px; border-radius:10px; background:linear-gradient(180deg,#171129,#0b0818); color:#cfc6ff;
  box-shadow:0 6px 16px #000a, 0 0 0 1px #ffffff12 inset;
}

/* 裏面の状態 */
.card.is-back .front{ pointer-events:none }
.card.is-flipped{ transform:rotateY(180deg) }

/* ===== Hint ===== */
.hint{ text-align:center; margin:8px 0 0; color:#c9bfff; opacity:.9 }

/* ===== Result ===== */
.result{ display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-top:18px }
.result-item{
  border-radius:14px; padding:14px; background:linear-gradient(180deg,#120d22,#0b0816);
  box-shadow:0 10px 26px #0008, 0 0 0 1px #ffffff12 inset;
}
.result-item::before{
  content:attr(data-trinity); display:block; font-size:12px; color:var(--gold); margin-bottom:4px; letter-spacing:.08em
}
.r-title{ margin:.2em 0 .4em; font-size:14px; color:#efeaff }
.r-text{ margin:0; color:#cfc7ff }
.closing{ margin:.6em 0 0; color:#ffdca6 }

/* ===== Global Glow (画面全体の光) ===== */
.global-glow{
  position:fixed; inset:0; pointer-events:none; opacity:0;
  background:
    radial-gradient(closest-side circle at 50% 50%, #ffffff, #ffeeb8, #bda6ff 60%, #0000 70%),
    radial-gradient(1000px 700px at 50% -10%, #ffdd9a33, #0000 60%),
    radial-gradient(1200px 900px at 50% 120%, #bca7ff2e, #0000 60%);
  filter: blur(16px);
  transition: opacity .35s ease;
}
.global-glow.is-on{
  animation: glowExpand 1.1s ease forwards;
}
@keyframes glowExpand{
  0%{ opacity:0; transform:scale(.9) }
  30%{ opacity:1; transform:scale(1) }
  100%{ opacity:0; transform:scale(1.12) }
}

/* クローズ演出（画面を静かに暗く） */
body.is-closed::after{
  content:""; position:fixed; inset:0; background:radial-gradient(220vw 220vh at 50% 50%, #0000 30%, #02010a 60%, #02010a);
  animation: fadeClose .9s ease forwards;
}
@keyframes fadeClose{ from{ opacity:0 } to{ opacity:1 } }

/* 動きに弱い人向け */
@media (prefers-reduced-motion: reduce){
  .card, .global-glow{ transition:none; animation:none }
}
