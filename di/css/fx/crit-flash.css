/* /di/css/fx/crit-flash.css
   PRO LIGHT (tap flash) — geometric AI flash + tarot sigil
   - Spawn element: <div class="fxTapFlash [is-perfect]"><div class="tarotSigil">...svg...</div></div>
   - Position via vars: --fx-x, --fx-y
*/

.fxTapFlash{
  position: fixed;
  left: 0; top: 0;
  width: 1px; height: 1px;
  transform: translate(var(--fx-x, 0px), var(--fx-y, 0px));
  pointer-events: none;
  z-index: 2147483000;
  opacity: 1;
  /* iOS/Safari: keep it crisp */
  transform-origin: 0 0;
  will-change: transform, opacity, filter;
}

/* ------------------------------------------------------------------
   1) tiny core (existing)
------------------------------------------------------------------ */
.fxTapFlash::before{
  content:"";
  position:absolute;
  left: -1px; top: -1px;
  width: 2px; height: 2px;
  transform: translate(-50%,-50%);
  border-radius: 999px;

  background: radial-gradient(circle,
    rgba(255,255,255,0.95) 0%,
    rgba(0,240,255,0.55) 35%,
    rgba(156,60,255,0.0) 75%
  );
  filter: drop-shadow(0 0 8px rgba(0,240,255,0.35))
          drop-shadow(0 0 10px rgba(156,60,255,0.25));
  animation: fxTapCore 120ms ease-out both;
}

/* ------------------------------------------------------------------
   2) geometric ring (existing) + slight upgrade on perfect
------------------------------------------------------------------ */
.fxTapFlash::after{
  content:"";
  position:absolute;
  left: 0; top: 0;

  /* default size */
  width: 110px; height: 110px;

  transform: translate(-50%,-50%);
  border-radius: 999px;

  background:
    radial-gradient(circle,
      rgba(0,0,0,0) 54%,
      rgba(0,240,255,0.35) 56%,
      rgba(0,0,0,0) 58%,
      rgba(156,60,255,0.22) 62%,
      rgba(0,0,0,0) 66%
    ),
    conic-gradient(from 0deg,
      rgba(0,240,255,0.0) 0deg 35deg,
      rgba(0,240,255,0.25) 35deg 45deg,
      rgba(156,60,255,0.0) 45deg 125deg,
      rgba(156,60,255,0.22) 125deg 135deg,
      rgba(0,240,255,0.0) 135deg 215deg,
      rgba(0,240,255,0.25) 215deg 225deg,
      rgba(156,60,255,0.0) 225deg 305deg,
      rgba(156,60,255,0.22) 305deg 315deg,
      rgba(0,240,255,0.0) 315deg 360deg
    );

  opacity: 0.95;
  filter: drop-shadow(0 0 10px rgba(0,240,255,0.18))
          drop-shadow(0 0 12px rgba(156,60,255,0.12));
  animation: fxTapSigil 120ms ease-out both;
}

/* Perfect: ring bigger + slightly more punch */
.fxTapFlash.is-perfect::after{
  width: 132px;
  height: 132px;
  opacity: 1;
  filter: drop-shadow(0 0 14px rgba(0,240,255,0.22))
          drop-shadow(0 0 18px rgba(156,60,255,0.16));
}

/* ------------------------------------------------------------------
   3) Tarot Sigil (NEW) — optional child element
------------------------------------------------------------------ */
.fxTapFlash .tarotSigil{
  position:absolute;
  left: 0; top: 0;
  width: 160px;
  height: 160px;
  transform: translate(-50%,-50%) scale(0.85) rotate(0deg);
  opacity: 0;
  pointer-events:none;
  will-change: transform, opacity, filter;
  /* makes it visible on bright bg */
  filter: drop-shadow(0 0 12px rgba(255,255,255,0.14))
          drop-shadow(0 0 14px rgba(0,240,255,0.18))
          drop-shadow(0 0 16px rgba(156,60,255,0.12));
}

.fxTapFlash .tarotSigil svg{
  width: 100%;
  height: 100%;
  display:block;
}

/* Normal hit */
.fxTapFlash .tarotSigil{
  animation: tarotIn 160ms cubic-bezier(.2,.9,.2,1) forwards;
}

/* Perfect hit */
.fxTapFlash.is-perfect .tarotSigil{
  animation: tarotPerfect 220ms cubic-bezier(.15,1,.3,1) forwards;
  filter: drop-shadow(0 0 16px rgba(255,255,255,0.18))
          drop-shadow(0 0 20px rgba(0,240,255,0.22))
          drop-shadow(0 0 22px rgba(156,60,255,0.16));
}

/* ------------------------------------------------------------------
   Animations
------------------------------------------------------------------ */
@keyframes fxTapCore{
  0%   { opacity:0; transform: translate(-50%,-50%) scale(0.65); }
  35%  { opacity:1; transform: translate(-50%,-50%) scale(1.05); }
  100% { opacity:0; transform: translate(-50%,-50%) scale(0.95); }
}

@keyframes fxTapSigil{
  0%   { opacity:0; transform: translate(-50%,-50%) scale(0.70) rotate(0deg); }
  40%  { opacity:0.95; transform: translate(-50%,-50%) scale(1.02) rotate(18deg); }
  100% { opacity:0; transform: translate(-50%,-50%) scale(0.92) rotate(30deg); }
}

@keyframes tarotIn{
  0%   { opacity:0; transform: translate(-50%,-50%) scale(0.75) rotate(0deg); }
  40%  { opacity:1; transform: translate(-50%,-50%) scale(1.05) rotate(18deg); }
  100% { opacity:0; transform: translate(-50%,-50%) scale(0.95) rotate(30deg); }
}

@keyframes tarotPerfect{
  0%   { opacity:0; transform: translate(-50%,-50%) scale(0.75) rotate(0deg); }
  35%  { opacity:1; transform: translate(-50%,-50%) scale(1.15) rotate(28deg); }
  100% { opacity:0; transform: translate(-50%,-50%) scale(1.05) rotate(60deg); }
}
