/* di/css/fx/fx-particles.css */

/* 粒子の基礎：星形・強い発光・サイズはCSS変数で */
.fx-particle{
  position:absolute;
  width: var(--fx-size, 14px);
  height: var(--fx-size, 14px);
  border-radius: 0; /* 円やめる */
  pointer-events:none;

  opacity: var(--fx-alpha, .95);
  will-change: transform, opacity, filter;
  transform:translate(-50%,-50%) translateZ(0);

  /* 星形 */
  -webkit-clip-path: polygon(
    50% 0%,
    61% 35%,
    98% 35%,
    68% 57%,
    79% 92%,
    50% 72%,
    21% 92%,
    32% 57%,
    2% 35%,
    39% 35%
  );
  clip-path: polygon(
    50% 0%,
    61% 35%,
    98% 35%,
    68% 57%,
    79% 92%,
    50% 72%,
    21% 92%,
    32% 57%,
    2% 35%,
    39% 35%
  );

  /* “芯”を明るく：中心白→res色 */
  background:
    radial-gradient(circle at 40% 35%,
      rgba(255,255,255,.95) 0%,
      color-mix(in srgb, var(--res-color) 80%, white) 32%,
      rgba(255,255,255,0) 70%
    );

  /* 光量アップ（A演出の中毒性はここ） */
  box-shadow:
    0 0 calc(var(--fx-size,14px) * .8) var(--res-color),
    0 0 calc(var(--fx-size,14px) * 1.8) var(--res-color),
    0 0 calc(var(--fx-size,14px) * 3.2) rgba(255,255,255,.22);

  mix-blend-mode: screen;
  filter: saturate(1.25) brightness(1.12);
}

/* 流星尾：streamだけ尾を出す */
.fx-particle.stream::after{
  content:"";
  position:absolute;
  left: 50%;
  top: 50%;
  width: calc(var(--fx-size,14px) * var(--fx-tail, 2.6));
  height: calc(var(--fx-size,14px) * .55);
  transform: translate(-10%, -50%) rotate(var(--fx-tail-rot, -18deg));
  transform-origin: 0% 50%;
  pointer-events:none;

  background: linear-gradient(90deg,
    rgba(255,255,255,.55),
    color-mix(in srgb, var(--res-color) 85%, transparent),
    rgba(0,0,0,0)
  );

  filter: blur(0.5px);
  opacity: .92;
}

/* 吸収アニメ：位置移動も含めたいならJSで left/top を動かすのでここは維持 */
.fx-particle.stream{
  transition:
    transform .55s cubic-bezier(.22,.8,.2,1),
    left .55s cubic-bezier(.22,.8,.2,1),
    top .55s cubic-bezier(.22,.8,.2,1),
    opacity .55s ease,
    filter .55s ease;
}

.fx-particle.absorbed{
  opacity:0;
  filter: brightness(1.4) blur(1px);
}
