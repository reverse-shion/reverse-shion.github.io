/* /di/css/core.css */
/* Layout + base rules + background video + stage + buttons */

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  font-family: var(--font);
  color: var(--text);

  /* base background (under video) */
  background:
    radial-gradient(1200px 700px at 18% 12%, rgba(156,60,255,.22), transparent 55%),
    radial-gradient(900px 560px at 82% 18%, rgba(0,240,255,.16), transparent 58%),
    radial-gradient(900px 700px at 56% 86%, rgba(230,201,107,.10), transparent 60%),
    linear-gradient(180deg, var(--bg0), var(--bg1));

  overflow:hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Disable accidental text selection on mobile */
.app, .app *{
  -webkit-tap-highlight-color: transparent;
}
.app{
  user-select:none;
  -webkit-user-select:none;

  position:relative;
  width:100%;
  height:100%;

  padding:
    env(safe-area-inset-top)
    env(safe-area-inset-right)
    calc(env(safe-area-inset-bottom) + var(--bottomH))
    env(safe-area-inset-left);
}

/* =========================
   Background Video
   ========================= */
.bgVideo{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  object-position:center;

  /* keep video visible */
  opacity:.92;

  /* gentle polish only (no darkening) */
  filter: saturate(1.06) contrast(1.06);

  transform: translateZ(0);
  z-index:0;
  pointer-events:none;
}

/* =========================
   Cinematic overlays
   - THIS was the "dark filter"
   - Now tuned brighter (lighter blacks)
   ========================= */

/* soft readability veil (lighter than before) */
.app::before{
  content:"";
  position:absolute;
  inset:0;
  z-index:1;

  /* â†“ reduced darkness:
     was ~ .22 -> .48 center
     now ~ .06 -> .18 center
  */
  background:
    radial-gradient(1100px 700px at 50% 50%,
      rgba(0,0,0,.06),
      rgba(0,0,0,.18)
    ),
    linear-gradient(90deg,
      rgba(0,0,0,.16) 0%,
      rgba(0,0,0,.06) 18%,
      rgba(0,0,0,.02) 50%,
      rgba(0,0,0,.06) 82%,
      rgba(0,0,0,.16) 100%
    );

  pointer-events:none;
}

/* color glow overlay (kept, slightly toned) */
.app::after{
  content:"";
  position:absolute;
  inset:-2px;
  z-index:1;

  background:
    radial-gradient(600px 300px at 24% 18%, rgba(156,60,255,.18), transparent 62%),
    radial-gradient(520px 260px at 76% 24%, rgba(0,240,255,.14), transparent 66%),
    radial-gradient(520px 320px at 56% 84%, rgba(230,201,107,.10), transparent 64%);

  mix-blend-mode: screen;
  opacity:.56;
  pointer-events:none;
  animation: glowPulse 6.5s ease-in-out infinite;
}

/* subtle pulse */
@keyframes glowPulse{
  0%   { opacity:.48; transform: translateZ(0) scale(1); }
  50%  { opacity:.62; transform: translateZ(0) scale(1.01); }
  100% { opacity:.48; transform: translateZ(0) scale(1); }
}

/* =========================
   FX layer
   ========================= */
.fxLayer{
  position:absolute;
  inset:0;
  z-index:5;
  pointer-events:none;
}

/* =========================
   Stage
   ========================= */
.stage{
  position:relative;
  z-index:3;

  width:100%;
  height:100%;

  display:flex;
  align-items:center;
  justify-content:center;

  padding:
    10px
    calc(var(--hudW) + var(--hudGap) + env(safe-area-inset-right))
    10px
    calc(var(--hudW) + var(--hudGap) + env(safe-area-inset-left));

  touch-action: manipulation;
}

/* gameplay canvas */
.noteCanvas{
  width: min(720px, 100%);
  height: min(86vh, 900px);
  display:block;

  border-radius: var(--r2);

  /* lighter glass so video feels brighter */
  background: rgba(0,0,0,.08);

  box-shadow: var(--sh1);
  outline: 1px solid rgba(255,255,255,.10);

  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);

  transform: translateZ(0);
  pointer-events:auto;
}

/* =========================
   Bottom controls
   ========================= */
.bottom{
  position:absolute;
  left:0; right:0;
  bottom:0;

  height: var(--bottomH);
  padding: 10px 14px calc(10px + env(safe-area-inset-bottom)) 14px;

  display:flex;
  gap:10px;
  align-items:center;
  justify-content:center;

  z-index:10;

  /* slightly lighter than before */
  background: linear-gradient(180deg, rgba(0,0,0,0), rgba(0,0,0,.46));
}

.btn{
  appearance:none;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  color: var(--text);

  border-radius: 999px;
  padding: 12px 16px;
  min-width: 110px;

  font-weight: 700;
  letter-spacing: .02em;

  box-shadow: var(--sh2);

  backdrop-filter: blur(var(--blur));
  -webkit-backdrop-filter: blur(var(--blur));

  cursor:pointer;
  transition: transform .08s ease, background .12s ease, border-color .12s ease;
}

.btn:active{ transform: translateY(1px) scale(.99); }
.btn:hover{ border-color: rgba(255,255,255,.22); }

.btn.primary{
  border-color: rgba(0,240,255,.28);
  background: linear-gradient(180deg, rgba(0,240,255,.22), rgba(156,60,255,.10));
}
.btn.primary:hover{
  border-color: rgba(0,240,255,.42);
}

/* SR only */
.srOnly{
  position:absolute !important;
  width:1px; height:1px;
  padding:0; margin:-1px;
  overflow:hidden; clip:rect(0,0,0,0);
  white-space:nowrap; border:0;
}

/* =========================
   Responsive
   ========================= */
@media (max-width: 860px){
  :root{ --hudW: 210px; }
  .noteCanvas{
    width: min(620px, 100%);
    height: min(84vh, 820px);
  }
}
@media (max-width: 720px){
  :root{ --hudW: 170px; }
  .stage{
    padding-left: calc(var(--hudW) + 10px + env(safe-area-inset-left));
    padding-right: calc(var(--hudW) + 10px + env(safe-area-inset-right));
  }
  .btn{ min-width: 96px; padding: 11px 14px; }
}
@media (max-width: 560px){
  :root{ --hudW: 150px; }
  .noteCanvas{
    border-radius: 18px;
    height: min(78vh, 760px);
  }
}
