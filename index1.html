<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="無料タロット占い。大アルカナ22枚で3枚リーディング。神秘の詩・韻・祈であなたの運命を解釈。"/>
  <title>Mystic Verse｜無料タロット占い - 詩・韻・祈</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">

  <!-- CSS -->
  <link rel="stylesheet" href="/style1.css?v=1">

  <!-- OGP -->
  <meta property="og:title" content="Mystic Verse｜無料タロット占い - 詩・韻・祈"/>
  <meta property="og:description" content="3枚のタロットがあなたの魂に響く。無料で今すぐ占う。"/>
  <meta property="og:image" content="https://reverse-shion.github.io/assets/ogp.jpg"/>
  <meta property="og:url" content="https://reverse-shion.github.io"/>
</head>
<body>

  <!-- 星空ヒーロー -->
  <section class="hero">
    <div class="stars"></div>
    <div class="fog"></div>
    <div class="hero-content">
      <h1>Mystic Verse</h1>
      <p>言葉は星の構文。魂は光の韻。</p>
      <button id="startBtn" class="btn-glow">無料占いを始める</button>
    </div>
    <audio id="bgm" src="assets/sound/temple-ambient.mp3" preload="auto" loop></audio>
  </section>

  <div class="container">
    <!-- イントロ -->
    <section class="intro hidden">
      <p class="guide">目を閉じて、願いを心に描いてください。<br>恋愛・仕事・未来、何でもOK。</p>
      <button id="drawBtn" class="btn-glow">タロットを引く</button>
    </section>

    <!-- 儀式 -->
    <div id="ritual" class="ritual">
      <p>星が囁く――</p>
      <p>あなたの運命を、詩に。</p>
    </div>

    <!-- タロット -->
    <section id="tarot" class="tarot hidden">
      <div class="tarot-grid">
        <div class="card" data-index="0">
          <div class="card-inner">
            <div class="card-back">
              <span>① 現在</span>
              <p>タップ</p>
            </div>
            <div class="card-front"><img src="" alt=""></div>
          </div>
        </div>
        <div class="card" data-index="1">
          <div class="card-inner">
            <div class="card-back">
              <span>② 鍵</span>
              <p>タップ</p>
            </div>
            <div class="card-front"><img src="" alt=""></div>
          </div>
        </div>
        <div class="card" data-index="2">
          <div class="card-inner">
            <div class="card-back">
              <span>③ 未来</span>
              <p>タップ</p>
            </div>
            <div class="card-front"><img src="" alt=""></div>
          </div>
        </div>
      </div>
    </section>

    <!-- 結果 -->
    <section id="result" class="result hidden">
      <div class="verse">
        <h3>詩 — <span id="poemTitle"></span></h3>
        <p id="poem"></p>
      </div>
      <div class="verse">
        <h3>韻 — <span id="rhymeTitle"></span></h3>
        <p id="rhyme"></p>
      </div>
      <div class="verse">
        <h3>祈 — <span id="prayerTitle"></span></h3>
        <p id="prayer"></p>
      </div>
      <button id="shareBtn" class="btn-share">結果をシェア</button>
      <button id="restartBtn" class="btn-restart">もう一度占う</button>
    </section>
  </div>

  <!-- 効果音 -->
  <audio id="flipSound" src="https://freesound.org/data/previews/351/351408_5665338-lq.mp3" preload="auto"></audio>

  <script>
    // タロットデータ
    const tarot = [
      { name: "The Fool", meaning: "新たな旅立ち、無垢、可能性。", img: "https://upload.wikimedia.org/wikipedia/commons/d/de/RWS_Tarot_00_Fool.jpg" },
      { name: "The Magician", meaning: "創造、意志、顕現。", img: "https://upload.wikimedia.org/wikipedia/commons/d/d1/RWS_Tarot_01_Magician.jpg" },
      { name: "The High Priestess", meaning: "直感、神秘、潜在意識。", img: "https://upload.wikimedia.org/wikipedia/commons/8/88/RWS_Tarot_02_High_Priestess.jpg" },
      { name: "The Empress", meaning: "豊かさ、愛、創造性。", img: "https://upload.wikimedia.org/wikipedia/commons/d/d2/RWS_Tarot_03_Empress.jpg" },
      { name: "The Emperor", meaning: "安定、権威、構造。", img: "https://upload.wikimedia.org/wikipedia/commons/c/c3/RWS_Tarot_04_Emperor.jpg" },
      { name: "The Hierophant", meaning: "伝統、指導、信仰。", img: "https://upload.wikimedia.org/wikipedia/commons/8/8d/RWS_Tarot_05_Hierophant.jpg" },
      { name: "The Lovers", meaning: "愛、選択、調和。", img: "https://upload.wikimedia.org/wikipedia/commons/d/d5/RWS_Tarot_06_Lovers.jpg" },
      { name: "The Chariot", meaning: "勝利、意志、進行。", img: "https://upload.wikimedia.org/wikipedia/commons/9/9b/RWS_Tarot_07_Chariot.jpg" },
      { name: "Strength", meaning: "勇気、忍耐、内なる力。", img: "https://upload.wikimedia.org/wikipedia/commons/f/f5/RWS_Tarot_08_Strength.jpg" },
      { name: "The Hermit", meaning: "内省、導き、孤独。", img: "https://upload.wikimedia.org/wikipedia/commons/4/4d/RWS_Tarot_09_Hermit.jpg" },
      { name: "Wheel of Fortune", meaning: "運命、変化、周期。", img: "https://upload.wikimedia.org/wikipedia/commons/3/3c/RWS_Tarot_10_Wheel_of_Fortune.jpg" },
      { name: "Justice", meaning: "公正、バランス、真実。", img: "https://upload.wikimedia.org/wikipedia/commons/e/e0/RWS_Tarot_11_Justice.jpg" },
      { name: "The Hanged Man", meaning: "犠牲、視点、降伏。", img: "https://upload.wikimedia.org/wikipedia/commons/2/2b/RWS_Tarot_12_Hanged_Man.jpg" },
      { name: "Death", meaning: "変容、終わり、新生。", img: "https://upload.wikimedia.org/wikipedia/commons/d/d7/RWS_Tarot_13_Death.jpg" },
      { name: "Temperance", meaning: "調和、統合、節度。", img: "https://upload.wikimedia.org/wikipedia/commons/f/f8/RWS_Tarot_14_Temperance.jpg" },
      { name: "The Devil", meaning: "束縛、誘惑、影。", img: "https://upload.wikimedia.org/wikipedia/commons/5/55/RWS_Tarot_15_Devil.jpg" },
      { name: "The Tower", meaning: "激変、啓示、崩壊。", img: "https://upload.wikimedia.org/wikipedia/commons/5/53/RWS_Tarot_16_Tower.jpg" },
      { name: "The Star", meaning: "希望、癒し、導き。", img: "https://upload.wikimedia.org/wikipedia/commons/d/db/RWS_Tarot_17_Star.jpg" },
      { name: "The Moon", meaning: "幻想、不安、直感。", img: "https://upload.wikimedia.org/wikipedia/commons/7/7f/RWS_Tarot_18_Moon.jpg" },
      { name: "The Sun", meaning: "成功、喜び、明晰。", img: "https://upload.wikimedia.org/wikipedia/commons/1/17/RWS_Tarot_19_Sun.jpg" },
      { name: "Judgement", meaning: "覚醒、赦し、再生。", img: "https://upload.wikimedia.org/wikipedia/commons/d/dd/RWS_Tarot_20_Judgement.jpg" },
      { name: "The World", meaning: "完成、統合、達成。", img: "https://upload.wikimedia.org/wikipedia/commons/f/ff/RWS_Tarot_21_World.jpg" }
    ];

    let deck = [], selected = [], seed;

    // シード
    const url = new URL(location.href);
    seed = url.searchParams.get('seed') ? Number(url.searchParams.get('seed')) : Date.now();
    url.searchParams.set('seed', seed);
    history.replaceState(null, '', url);

    // シャッフル
    function shuffle(arr, s) {
      let a = [...arr], x = s;
      for (let i = a.length - 1; i > 0; i--) {
        x ^= x << 13; x ^= x >>> 17; x ^= x << 5;
        const j = Math.abs(x) % (i + 1);
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    // 開始
    document.getElementById('startBtn').onclick = () => {
      document.querySelector('.hero').classList.add('fade');
      setTimeout(() => {
        document.querySelector('.intro').classList.remove('hidden');
        document.querySelector('.hero').style.display = 'none';
      }, 800);
      document.getElementById('bgm').play().catch(() => {});
    };

    document.getElementById('drawBtn').onclick = () => {
      document.querySelector('.intro').classList.add('hidden');
      document.getElementById('ritual').classList.add('show');
      setTimeout(() => {
        deck = shuffle(tarot, seed);
        selected = deck.slice(0, 3);
        document.getElementById('tarot').classList.remove('hidden');
        document.getElementById('ritual').classList.remove('show');
      }, 2000);
    };

    // カードめくり
    document.querySelectorAll('.card').forEach(card => {
      card.onclick = () => {
        if (card.classList.contains('flipped')) return;
        card.classList.add('flipped');
        const idx = card.dataset.index;
        const img = card.querySelector('img');
        img.src = selected[idx].img;
        img.alt = selected[idx].name;
        document.getElementById('flipSound').play();
        if ([...document.querySelectorAll('.card.flipped')].length === 3) {
          setTimeout(showResult, 800);
        }
      };
    });

    function showResult() {
      const [c1, c2, c3] = selected;
      document.getElementById('poemTitle').textContent = c1.name;
      document.getElementById('rhymeTitle').textContent = c2.name;
      document.getElementById('prayerTitle').textContent = c3.name;
      document.getElementById('poem').textContent = `いま、あなたの魂は「${c1.name}」。${c1.meaning}光が灯る。`;
      document.getElementById('rhyme').textContent = `鍵は「${c2.name}」。${c2.meaning}行動の韻が響く。`;
      document.getElementById('prayer').textContent = `未来は「${c3.name}」。${c3.meaning}大丈夫だよ。`;
      document.getElementById('result').classList.remove('hidden');
    }

    document.getElementById('restartBtn').onclick = () => location.reload();
    document.getElementById('shareBtn').onclick = () => {
      const url = location.href;
      navigator.clipboard.writeText(url).then(() => alert('URLをコピーしました！'));
    };
  </script>
</body>
</html>
