/* ============================================================
   SV SKIT — PERFECT MINIMAL (Images + Dialogue only)
   - 余計な箱/面/背景を撤去
   - 画像は“目線位置”に固定（上段）
   - セリフはその直下（下段）
   - 512x512想定 / 3人同席
============================================================ */

/* ---- Root ---- */
#sv-skit{
  position: fixed;
  inset: 0;
  z-index: 9999;
  font-family: 'Noto Sans JP','Inter',system-ui,-apple-system,sans-serif;
  pointer-events: none;
}
#sv-skit *{ box-sizing: border-box; }

/* ---- Overlay ---- */
#sv-skit .sv-overlay{
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  pointer-events: auto;
}
#sv-skit .sv-overlay.sv-hidden{ display: none; }

/* 背景は“薄く”だけ（ページが見える前提） */
#sv-skit .sv-overlay-backdrop{
  position: absolute;
  inset: 0;
  background: rgba(5,7,12,.16);
  backdrop-filter: blur(1px) saturate(1.05);
}

/* ---- Panel = 箱を作らない / レイアウトの器だけ ---- */
#sv-skit .sv-overlay-panel{
  position: relative;
  width: min(980px, 96vw);
  height: min(720px, 92vh);

  background: transparent;
  border: none;
  border-radius: 0;
  box-shadow: none;

  overflow: visible;
  pointer-events: auto;
}

/* 使わないUIは完全に消す */
#sv-skit .sv-overlay-header,
#sv-skit .sv-topbar,
#sv-skit .sv-controls,
#sv-skit .sv-log-panel,
#sv-skit .sv-hint,
#sv-skit .sv-launch-btn{
  display: none !important;
}

/* ---- Body ---- */
#sv-skit .sv-overlay-body{
  height: 100%;
  padding: 0;
}

/* ============================================================
   Layout: 2 rows (images / dialogue)
   余白ゼロ、被りゼロ
============================================================ */
#sv-skit .sv-shell{
  height: 100%;
  display: grid;
  grid-template-rows: 1fr auto;
  gap: 0;
}

/* ============================================================
   Images (Stage)
   “目線位置”へ：上段の中で中央より少し上
============================================================ */
#sv-skit .sv-stage{
  /* 余計な面を完全撤去 */
  background: transparent;
  border: none;
  border-radius: 0;
  box-shadow: none;

  margin: 0;
  padding: 0;

  display: grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap: clamp(6px, 1.6vw, 12px);
  align-items: end;

  /* ここが目線位置の要：上段を“固定高”にして、少し上へ */
  height: min(46vh, 360px);
  align-self: center;
  transform: translateY(-5vh);
}

/* Slot */
#sv-skit .sv-slot{
  height: 100%;
  min-height: 0;
  display: flex;
  align-items: flex-end;
  justify-content: center;

  /* うっすら面が出るのを防止 */
  background: transparent;
  border: none;
  box-shadow: none;
}

/* Portrait = 画像を載せる最小の“縁”だけ（面は作らない） */
#sv-skit .sv-portrait{
  width: 100%;
  height: 100%;
  max-width: 280px;

  /* ★ここが“うっすらエリア残り”対策の核心 */
  background: transparent;     /* 面を作らない */
  border: none;                /* 枠も消す（必要なら後述でON） */
  box-shadow: none;            /* 影も消す（必要なら speaking だけ付ける） */

  border-radius: 18px;
  overflow: hidden;

  position: relative;
}
#sv-skit .sv-portrait::before{ content: "" !important; }

/* Face */
#sv-skit .sv-face{
  width: 100%;
  height: 100%;
  display: block;

  background-size: contain;
  background-repeat: no-repeat;
  background-position: center bottom;
}

/* Speaking = “存在感”だけ足す（箱を作らない光） */
#sv-skit .sv-slot.sv-speaking{
  transform: translateY(-6px) scale(1.02);
}
#sv-skit .sv-slot.sv-speaking .sv-portrait{
  /* 面ではなく“光の縁”だけ */
  filter: brightness(1.04) saturate(1.03);
  box-shadow: 0 10px 28px rgba(130,175,255,.25);
}

/* Dimmed */
#sv-skit .sv-slot.sv-dimmed{
  opacity: .86;
  filter: saturate(.92) brightness(.98);
}

/* ============================================================
   Dialogue (下段)
   画像の直下 / 余白ゼロ / 読みやすさだけ確保
============================================================ */
#sv-skit .sv-dialogue{
  margin: 0;
  padding: 14px 16px 16px;

  min-height: 132px;
  border-radius: 18px;

  background: rgba(255,255,255,.92);
  border: 1px solid rgba(160,205,255,.42);
  box-shadow: 0 12px 30px rgba(0,0,0,.18), 0 0 0 1px rgba(255,255,255,.40) inset;

  display: flex;
  flex-direction: column;
  gap: 8px;

  cursor: pointer;
}

#sv-skit .sv-name{
  display: inline-flex;
  align-items: center;
  width: fit-content;
  padding: 5px 12px;

  border-radius: 999px;
  background: rgba(130,175,255,.18);
  border: 1px solid rgba(130,175,255,.34);
  color: rgba(10,12,18,.92);

  font-weight: 700;
  font-size: 13px;
  letter-spacing: .04em;
}

#sv-skit .sv-text{
  color: rgba(10,12,18,.92);
  font-size: 16px;
  line-height: 1.65;
  white-space: pre-line;
}

/* choices */
#sv-skit .sv-choices{
  display: grid;
  gap: 8px;
  margin-top: 6px;
}
#sv-skit .sv-choice-btn{
  background: rgba(255,255,255,.90);
  border: 1px solid rgba(160,205,255,.34);
  color: rgba(10,12,18,.88);

  border-radius: 14px;
  padding: 12px 12px;
  text-align: left;

  cursor: pointer;
  transition: transform .18s ease, background .18s ease, border-color .18s ease;
}
#sv-skit .sv-choice-btn:hover,
#sv-skit .sv-choice-btn:focus-visible{
  transform: translateY(-1px);
  background: rgba(255,255,255,.98);
  border-color: rgba(130,175,255,.52);
  outline: none;
}

/* motion */
#sv-skit .sv-motion-shake{ animation: sv-shake .5s ease; }
@keyframes sv-shake{
  0%{ transform: translateX(0); }
  20%{ transform: translateX(-6px); }
  40%{ transform: translateX(6px); }
  60%{ transform: translateX(-3px); }
  80%{ transform: translateX(3px); }
  100%{ transform: translateX(0); }
}
#sv-skit .sv-motion-zoomIn{ animation: sv-zoomIn .6s ease; }
@keyframes sv-zoomIn{
  0%{ transform: scale(.95); opacity: .65; }
  100%{ transform: scale(1); opacity: 1; }
}

body.sv-skit-lock{ overflow: hidden; }

/* ============================================================
   Mobile tuning
   - 目線位置を上げすぎない
   - 画像を少しだけ大きく見せる
============================================================ */
@media (max-width: 720px){
  #sv-skit .sv-overlay-panel{
    width: 96vw;
    height: 92vh;
  }

  #sv-skit .sv-stage{
    height: min(44vh, 320px);
    transform: translateY(-3.5vh);
    gap: 8px;
  }

  #sv-skit .sv-portrait{
    max-width: 240px;
    border-radius: 16px;
  }

  #sv-skit .sv-text{
    font-size: 15.5px;
    line-height: 1.7;
  }
}
