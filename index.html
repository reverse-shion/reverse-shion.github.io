<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <title>Re:verse Shion — 詩韻思想 × TAROT BREAKER</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0b0b1a" />
  <meta name="description" content="言葉が魂を救い、魂が世界を調和させ、沈黙が祈りに変わる。物語と思想が重なる“星の構文”。" />
  <link rel="canonical" href="https://reverse-shion.github.io/" />

  <!-- フォント（遅延読込） -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Zen+Old+Mincho:wght@400;700&display=swap" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=Zen+Old+Mincho:wght@400;700&display=swap"></noscript>

  <!-- 画像・音のパスは実ファイルに合わせて変更OK -->
  <link rel="preload" as="image" href="/assets/hero-poster.jpg">
  <link rel="preload" as="audio" href="/assets/audio/flip.mp3">
  <link rel="preload" as="audio" href="/assets/audio/chime.mp3">

  <link rel="stylesheet" href="/assets/css/style.css" />
</head>
<body>

  <!-- Header -->
  <header class="site-header" id="siteHeader">
    <div class="wrap">
      <div class="brand__dot" aria-hidden="true"></div>
      <div class="brand__text">Re:verse Shion</div>
      <div class="brand__sub">詩韻思想 × TAROT BREAKER</div>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero" id="top">
    <div class="hero__media" aria-hidden="true">
      <video class="hero__video" autoplay muted loop playsinline poster="/assets/hero-poster.jpg">
        <source src="/assets/video/top.webm" type="video/webm">
        <source src="/assets/video/top.mp4"  type="video/mp4">
      </video>
      <div class="hero__veil"></div>
    </div>
    <div class="wrap">
      <h1>言葉は祈りの構文。物語は、その実演。</h1>
      <p>詩韻思想®で“響き”を学び、TAROT BREAKERで“響き”を体験する。<br><strong>— 星の声が、あなたに届く。</strong></p>
      <div class="cta-row">
        <a class="btn btn--primary" href="https://lin.ee/LYnlU0f" target="_blank" rel="noopener">🌠 星の言葉を受け取る（無料）</a>
        <a class="btn btn--ghost" href="https://ncode.syosetu.com/n5806lb/" target="_blank" rel="noopener">📘 小説を読む</a>
        <a class="btn btn--ghost" href="https://note.com/shion_uranai369" target="_blank" rel="noopener">📖 今日の“響き”</a>
        <a class="btn btn--ghost" href="https://www.tiktok.com/@tarotbreaker" target="_blank" rel="noopener">🎥 1分で観る/聴く</a>
      </div>
    </div>
  </section>

  <!-- Trinity -->
  <section id="trinity">
    <div class="wrap">
      <h2>詩韻思想</h2>
      <div class="h2-sub">Trinity（詩・韻・祈）</div>

      <figure class="trinity__figure">
        <video id="trinityVideo" class="trinity__video" autoplay muted loop playsinline poster="/assets/trinity/banner.png">
          <source src="/assets/trinity/loop.webm" type="video/webm">
          <source src="/assets/trinity/loop.mp4"  type="video/mp4">
        </video>
      </figure>

      <div class="cta-row">
        <button id="trinityPlay" class="btn btn--primary">▶ 画面タップで音が流れます</button>
      </div>
    </div>
  </section>

  <!-- Codex -->
  <section id="writings">
    <div class="wrap">
      <h2>📖 書・物語</h2>
      <ul class="codex__list">
        <li class="codex__item"><span class="badge">✡ 第零書</span> 無限構文序論 — <em>The Zero Syntax</em></li>
        <li class="codex__item"><span class="badge">✦ 第一書</span> 言葉が魂を救う理由 — <em>The Syntax of Salvation</em></li>
        <li class="codex__item"><span class="badge">✦ TAROT BREAKER</span> 第1話から読む（1分体験あり）</li>
      </ul>
    </div>
  </section>

  <!-- Mini Reading -->
  <section id="mini-reading">
    <div class="wrap">
      <h2>🃏 3枚リーディング（体験）</h2>
      <div class="h2-sub">現在／鍵／進む道 を1分で。</div>

      <div class="reading-ui" aria-live="polite">
        <canvas id="ripple" class="ripple"></canvas>

        <div class="reading-actions">
          <button id="btnStart" class="btn btn--primary">シャッフルして始める</button>
          <button id="btnReset" class="btn btn--ghost" disabled>リセット</button>
        </div>

        <div class="deck" id="deck">
          <!-- 1 -->
          <div class="card-wrap">
            <button class="card" data-slot="1" disabled aria-label="1枚目を引く">
              <span class="card__face card__face--back"  style="background-image:url('/assets/images/tarot/tarot_back_1024x1536.jpg')"></span>
              <span class="card__face card__face--front" style="background-image:url('/assets/images/tarot/face_generic.jpg')"></span>
            </button>
            <div class="caption" data-cap="1"></div>
          </div>
          <!-- 2 -->
          <div class="card-wrap">
            <button class="card" data-slot="2" disabled aria-label="2枚目を引く">
              <span class="card__face card__face--back"  style="background-image:url('/assets/images/tarot/tarot_back_1024x1536.jpg')"></span>
              <span class="card__face card__face--front" style="background-image:url('/assets/images/tarot/face_generic.jpg')"></span>
            </button>
            <div class="caption" data-cap="2"></div>
          </div>
          <!-- 3 -->
          <div class="card-wrap">
            <button class="card" data-slot="3" disabled aria-label="3枚目を引く">
              <span class="card__face card__face--back"  style="background-image:url('/assets/images/tarot/tarot_back_1024x1536.jpg')"></span>
              <span class="card__face card__face--front" style="background-image:url('/assets/images/tarot/face_generic.jpg')"></span>
            </button>
            <div class="caption" data-cap="3"></div>
          </div>
        </div>

        <div id="result" class="result" hidden>
          <div class="result__item"><div class="badge">① 現在</div><h4 data-t="1">—</h4><p data-p="1">—</p></div>
          <div class="result__item"><div class="badge">② 鍵</div><h4 data-t="2">—</h4><p data-p="2">—</p></div>
          <div class="result__item"><div class="badge">③ 進む道</div><h4 data-t="3">—</h4><p data-p="3">—</p></div>
        </div>
      </div>
    </div>
  </section>

  <!-- Join -->
  <section id="join">
    <div class="wrap">
      <h2>参加の扉</h2>
      <div class="h2-sub">LINE登録で、毎週「星の言葉」をお届け。</div>
      <div class="cta-row">
        <a class="btn btn--primary" href="https://lin.ee/LYnlU0f" target="_blank" rel="noopener">💫 無料で受け取る</a>
        <a class="btn btn--ghost" href="#top">▲ ページ先頭へ</a>
      </div>
    </div>
  </section>

  <footer>
    <div class="wrap">
      <div class="sns">
        <a href="https://x.com/TaroBure" target="_blank" rel="noopener">X</a>
        <a href="https://www.instagram.com/shion.codex" target="_blank" rel="noopener">Instagram</a>
        <a href="https://note.com/shion_uranai369" target="_blank" rel="noopener">note</a>
        <a href="https://ncode.syosetu.com/n5806lb/" target="_blank" rel="noopener">小説(なろう)</a>
      </div>
      <small>© Re:verse Shion — 詩韻思想 / TAROT BREAKER</small>
    </div>
  </footer>

  <!-- ===== Inline JS（依存ゼロ／安定版） ===== -->
  <script>
  // --- Header show/hide on scroll ---
  (function(){
    const header = document.getElementById('siteHeader');
    if(!header) return;
    let timer=null;
    const show=()=>{header.classList.add('is-visible');clearTimeout(timer);timer=setTimeout(()=>header.classList.remove('is-visible'),1200)};
    window.addEventListener('scroll',()=>{requestAnimationFrame(show)},{passive:true});
    // 初回表示
    show();
  })();

  // --- Trinity video tap to unmute ---
  (function(){
    const v=document.getElementById('trinityVideo');
    const b=document.getElementById('trinityPlay');
    if(!v||!b) return;
    const enable=async()=>{try{v.muted=false;const p=v.play();if(p&&p.then) await p;b.textContent='♪ 再生中';b.disabled=true;}catch(e){b.textContent='再生できません。もう一度';}}
    v.addEventListener('click',enable);
    b.addEventListener('click',enable);
  })();

  // --- Mini Reading: core ---
  (function(){
    const btnStart=document.getElementById('btnStart');
    const btnReset=document.getElementById('btnReset');
    const cards=[...document.querySelectorAll('.card')];
    const cap = i=>document.querySelector('.caption[data-cap="'+i+'"]');
    const rTitle = i=>document.querySelector('[data-t="'+i+'"]');
    const rText  = i=>document.querySelector('[data-p="'+i+'"]');
    const result = document.getElementById('result');

    const audioFlip = new Audio('/assets/audio/flip.mp3');
    const audioDone = new Audio('/assets/audio/chime.mp3');
    audioFlip.volume=.75; audioDone.volume=.85;

    const CARDS=[
      {n:'愚者',k:'自由に踏み出す'},{n:'魔術師',k:'いま始める'},
      {n:'女教皇',k:'静かに見極める'},{n:'女帝',k:'受け取り育てる'},
      {n:'皇帝',k:'決めて動かす'},{n:'教皇',k:'信頼に寄る'},
      {n:'恋人',k:'選び抜く'},{n:'戦車',k:'突破する'},
      {n:'力',k:'優しさで制す'},{n:'隠者',k:'内に灯す'},
      {n:'運命の輪',k:'流れに乗る'},{n:'正義',k:'整えバランス'},
      {n:'吊るされた男',k:'意味を反転'},{n:'死神',k:'一度終わらせる'},
      {n:'節制',k:'混ぜ調和する'},{n:'悪魔',k:'執着を手放す'},
      {n:'塔',k:'壊して更新'},{n:'星',k:'希望を見る'},
      {n:'月',k:'不安を識る'},{n:'太陽',k:'喜びで進む'},
      {n:'審判',k:'呼び覚ます'},{n:'世界',k:'完成し次へ'}
    ];
    const shuffle=a=>{const x=a.slice();for(let i=x.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[x[i],x[j]]=[x[j],x[i]];}return x};

    // Ripple canvas (星環)
    const canvas=document.getElementById('ripple');
    const ctx=canvas.getContext('2d');
    let dpr=window.devicePixelRatio||1, ripples=[], anim=false;
    const fit=()=>{const r=canvas.parentElement.getBoundingClientRect();canvas.width=r.width*dpr;canvas.height=r.height*dpr;canvas.style.width=r.width+'px';canvas.style.height=r.height+'px';ctx.setTransform(dpr,0,0,dpr,0,0);}
    window.addEventListener('resize',fit); fit();
    const spawn=(x,y)=>{const t=performance.now();const col=['rgba(255,215,111,0.7)','rgba(174,138,255,0.55)','rgba(255,255,255,0.4)'];for(let i=0;i<3;i++){ripples.push({x,y,t0:t,delay:i*80,col:col[i]})} canvas.style.opacity='1'; if(!anim){anim=true;requestAnimationFrame(draw)}}
    const draw=(now)=>{ctx.clearRect(0,0,canvas.width/dpr,canvas.height/dpr);ripples=ripples.filter(r=>{const e=now-r.t0-r.delay;if(e<0)return true;const ratio=Math.min(1,e*0.001*0.9),R=ratio*120,A=(1-ratio)*0.6;if(A<=.01)return false;ctx.beginPath();ctx.arc(r.x,r.y,R,0,Math.PI*2);ctx.strokeStyle=r.col.replace(/0\.\d+/,A.toFixed(2));ctx.lineWidth=2+(1-ratio)*3;ctx.stroke();return true}); if(ripples.length){requestAnimationFrame(draw)}else{anim=false;canvas.style.opacity='0'}}
    const center=(el)=>{const r=el.getBoundingClientRect();const p=canvas.parentElement.getBoundingClientRect();return {x:r.left+r.width/2-p.left,y:r.top+r.height/2-p.top}}

    let stack=[], picked={};

    function reset(){
      cards.forEach(c=>{c.classList.remove('is-picked');c.disabled=true});
      [1,2,3].forEach(i=>{cap(i).textContent='';cap(i).classList.remove('is-show');rTitle(i).textContent='—';rText(i).textContent='—'});
      result.hidden=true; btnReset.disabled=true; btnStart.disabled=false; picked={}; ripples=[];
    }
    function start(){
      stack=shuffle(CARDS);
      cards.forEach(c=>c.disabled=false);
      btnStart.disabled=true; btnReset.disabled=false;
    }
    function reveal(slot, btn){
      if(picked[slot]) return;
      const card=stack.pop(); picked[slot]=card;
      btn.classList.add('is-picked');
      try{audioFlip.currentTime=0;audioFlip.play()}catch(_){}
      cap(slot).textContent=card.n; cap(slot).classList.add('is-show');
      rTitle(slot).textContent=card.n; rText(slot).textContent=card.k+'。';

      const {x,y}=center(btn); spawn(x,y);

      if(picked[1]&&picked[2]&&picked[3]){
        result.hidden=false;
        // 1分用の短い導き
        rText(1).textContent=picked[1].k+'。まず自分の今を受け止めると整う。';
        rText(2).textContent=picked[2].k+'。今日ひとつだけ実行する約束を。';
        rText(3).textContent=picked[3].k+'。小さく始めて継続が道になる。';
        try{audioDone.currentTime=0;audioDone.play()}catch(_){}
      }
    }

    reset();
    btnStart.addEventListener('click',start);
    btnReset.addEventListener('click',reset);
    cards.forEach(btn=>btn.addEventListener('click',()=>{ if(!btn.disabled) reveal(btn.dataset.slot, btn) }));
  })();
  </script>
</body>
</html>
